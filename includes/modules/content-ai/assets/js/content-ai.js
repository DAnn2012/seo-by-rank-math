!function(){var t={634:function(t){t.exports=function(){"use strict";function t(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function e(e){for(var a=1;a<arguments.length;a++){var i=null!=arguments[a]?arguments[a]:{};a%2?t(Object(i),!0).forEach((function(t){n(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):t(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function n(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var a=n.call(t,e||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const a=(t,e,n,a)=>(t=""+t,e=""+e,a&&(t=t.trim(),e=e.trim()),n?t==e:t.toLowerCase()==e.toLowerCase()),i=(t,e)=>t&&Array.isArray(t)&&t.map((t=>r(t,e)));function r(t,e){var n,a={};for(n in t)e.indexOf(n)<0&&(a[n]=t[n]);return a}function s(t){var e=document.createElement("div");return t.replace(/\&#?[0-9a-z]+;/gi,(function(t){return e.innerHTML=t,e.innerText}))}function o(t){return(new DOMParser).parseFromString(t.trim(),"text/html").body.firstElementChild}function l(t,e){for(e=e||"previous";t=t[e+"Sibling"];)if(3==t.nodeType)return t}function c(t){return"string"==typeof t?t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/`|'/g,"&#039;"):t}function d(t){var e=Object.prototype.toString.call(t).split(" ")[1].slice(0,-1);return t===Object(t)&&"Array"!=e&&"Function"!=e&&"RegExp"!=e&&"HTMLUnknownElement"!=e}function u(t,e,n){function a(t,e){for(var n in e)if(e.hasOwnProperty(n)){if(d(e[n])){d(t[n])?a(t[n],e[n]):t[n]=Object.assign({},e[n]);continue}if(Array.isArray(e[n])){t[n]=Object.assign([],e[n]);continue}t[n]=e[n]}}return t instanceof Object||(t={}),a(t,e),n&&a(t,n),t}function h(){const t=[],e={};for(let n of arguments)for(let a of n)d(a)?e[a.value]||(t.push(a),e[a.value]=1):t.includes(a)||t.push(a);return t}function p(t){return String.prototype.normalize?"string"==typeof t?t.normalize("NFD").replace(/[\u0300-\u036f]/g,""):void 0:t}var m=()=>/(?=.*chrome)(?=.*android)/i.test(navigator.userAgent);function g(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(t=>(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)))}function f(t){return t&&t.classList&&t.classList.contains(this.settings.classNames.tag)}function v(t,e){var n=window.getSelection();return e=e||n.getRangeAt(0),"string"==typeof t&&(t=document.createTextNode(t)),e&&(e.deleteContents(),e.insertNode(t)),t}function y(t,e,n){return t?(e&&(t.__tagifyTagData=n?e:u({},t.__tagifyTagData||{},e)),t.__tagifyTagData):(console.warn("tag element doesn't exist",t,e),e)}var w={delimiters:",",pattern:null,tagTextProp:"value",maxTags:1/0,callbacks:{},addTagOnBlur:!0,onChangeAfterBlur:!0,duplicates:!1,whitelist:[],blacklist:[],enforceWhitelist:!1,userInput:!0,keepInvalidTags:!1,createInvalidTags:!0,mixTagsAllowedAfter:/,|\.|\:|\s/,mixTagsInterpolator:["[[","]]"],backspace:!0,skipInvalid:!1,pasteAsTags:!0,editTags:{clicks:2,keepInvalid:!0},transformTag:()=>{},trim:!0,a11y:{focusableTags:!1},mixMode:{insertAfterTag:"Â "},autoComplete:{enabled:!0,rightKey:!1},classNames:{namespace:"tagify",mixMode:"tagify--mix",selectMode:"tagify--select",input:"tagify__input",focus:"tagify--focus",tagNoAnimation:"tagify--noAnim",tagInvalid:"tagify--invalid",tagNotAllowed:"tagify--notAllowed",scopeLoading:"tagify--loading",hasMaxTags:"tagify--hasMaxTags",hasNoTags:"tagify--noTags",empty:"tagify--empty",inputInvalid:"tagify__input--invalid",dropdown:"tagify__dropdown",dropdownWrapper:"tagify__dropdown__wrapper",dropdownHeader:"tagify__dropdown__header",dropdownFooter:"tagify__dropdown__footer",dropdownItem:"tagify__dropdown__item",dropdownItemActive:"tagify__dropdown__item--active",dropdownItemHidden:"tagify__dropdown__item--hidden",dropdownInital:"tagify__dropdown--initial",tag:"tagify__tag",tagText:"tagify__tag-text",tagX:"tagify__tag__removeBtn",tagLoading:"tagify__tag--loading",tagEditing:"tagify__tag--editable",tagFlash:"tagify__tag--flash",tagHide:"tagify__tag--hide"},dropdown:{classname:"",enabled:2,maxItems:10,searchKeys:["value","searchBy"],fuzzySearch:!0,caseSensitive:!1,accentedSearch:!0,includeSelectedTags:!1,highlightFirst:!1,closeOnSelect:!0,clearOnSelect:!0,position:"all",appendTarget:null},hooks:{beforeRemoveTag:()=>Promise.resolve(),beforePaste:()=>Promise.resolve(),suggestionClick:()=>Promise.resolve()}};function b(){this.dropdown={};for(let t in this._dropdown)this.dropdown[t]="function"==typeof this._dropdown[t]?this._dropdown[t].bind(this):this._dropdown[t];this.dropdown.refs()}var k={refs(){this.DOM.dropdown=this.parseTemplate("dropdown",[this.settings]),this.DOM.dropdown.content=this.DOM.dropdown.querySelector("[data-selector='tagify-suggestions-wrapper']")},getHeaderRef(){return this.DOM.dropdown.querySelector("[data-selector='tagify-suggestions-header']")},getFooterRef(){return this.DOM.dropdown.querySelector("[data-selector='tagify-suggestions-footer']")},getAllSuggestionsRefs(){return[...this.DOM.dropdown.content.querySelectorAll(this.settings.classNames.dropdownItemSelector)]},show(t){var e,n,i,r=this.settings,s="mix"==r.mode&&!r.enforceWhitelist,o=!r.whitelist||!r.whitelist.length,l="manual"==r.dropdown.position;if(t=void 0===t?this.state.inputText:t,!(o&&!s&&!r.templates.dropdownItemNoMatch||!1===r.dropdown.enable||this.state.isLoading||this.settings.readonly)){if(clearTimeout(this.dropdownHide__bindEventsTimeout),this.suggestedListItems=this.dropdown.filterListItems(t),t&&!this.suggestedListItems.length&&(this.trigger("dropdown:noMatch",t),r.templates.dropdownItemNoMatch&&(i=r.templates.dropdownItemNoMatch.call(this,{value:t}))),!i){if(this.suggestedListItems.length)t&&s&&!this.state.editing.scope&&!a(this.suggestedListItems[0].value,t)&&this.suggestedListItems.unshift({value:t});else{if(!t||!s||this.state.editing.scope)return this.input.autocomplete.suggest.call(this),void this.dropdown.hide();this.suggestedListItems=[{value:t}]}n=""+(d(e=this.suggestedListItems[0])?e.value:e),r.autoComplete&&n&&0==n.indexOf(t)&&this.input.autocomplete.suggest.call(this,e)}this.dropdown.fill(i),r.dropdown.highlightFirst&&this.dropdown.highlightOption(this.DOM.dropdown.content.querySelector(r.classNames.dropdownItemSelector)),this.state.dropdown.visible||setTimeout(this.dropdown.events.binding.bind(this)),this.state.dropdown.visible=t||!0,this.state.dropdown.query=t,this.setStateSelection(),l||setTimeout((()=>{this.dropdown.position(),this.dropdown.render()})),setTimeout((()=>{this.trigger("dropdown:show",this.DOM.dropdown)}))}},hide(t){var e=this.DOM,n=e.scope,a=e.dropdown,i="manual"==this.settings.dropdown.position&&!t;if(a&&document.body.contains(a)&&!i)return window.removeEventListener("resize",this.dropdown.position),this.dropdown.events.binding.call(this,!1),n.setAttribute("aria-expanded",!1),a.parentNode.removeChild(a),setTimeout((()=>{this.state.dropdown.visible=!1}),100),this.state.dropdown.query=this.state.ddItemData=this.state.ddItemElm=this.state.selection=null,this.state.tag&&this.state.tag.value.length&&(this.state.flaggedTags[this.state.tag.baseOffset]=this.state.tag),this.trigger("dropdown:hide",a),this},toggle(t){this.dropdown[this.state.dropdown.visible&&!t?"hide":"show"]()},render(){var t,e,n=((e=this.DOM.dropdown.cloneNode(!0)).style.cssText="position:fixed; top:-9999px; opacity:0",document.body.appendChild(e),t=e.clientHeight,e.parentNode.removeChild(e),t),a=this.settings;return"number"==typeof a.dropdown.enabled&&a.dropdown.enabled>=0?(this.DOM.scope.setAttribute("aria-expanded",!0),document.body.contains(this.DOM.dropdown)||(this.DOM.dropdown.classList.add(a.classNames.dropdownInital),this.dropdown.position(n),a.dropdown.appendTarget.appendChild(this.DOM.dropdown),setTimeout((()=>this.DOM.dropdown.classList.remove(a.classNames.dropdownInital)))),this):this},fill(t){t="string"==typeof t?t:this.dropdown.createListHTML(t||this.suggestedListItems);var e,n=this.settings.templates.dropdownContent.call(this,t);this.DOM.dropdown.content.innerHTML=(e=n)?e.replace(/\>[\r\n ]+\</g,"><").replace(/(<.*?>)|\s+/g,((t,e)=>e||" ")):""},fillHeaderFooter(){var t=this.dropdown.filterListItems(this.state.dropdown.query),e=this.parseTemplate("dropdownHeader",[t]),n=this.parseTemplate("dropdownFooter",[t]),a=this.dropdown.getHeaderRef(),i=this.dropdown.getFooterRef();e&&a?.parentNode.replaceChild(e,a),n&&i?.parentNode.replaceChild(n,i)},refilter(t){t=t||this.state.dropdown.query||"",this.suggestedListItems=this.dropdown.filterListItems(t),this.dropdown.fill(),this.suggestedListItems.length||this.dropdown.hide(),this.trigger("dropdown:updated",this.DOM.dropdown)},position(t){var e=this.settings.dropdown;if("manual"!=e.position){var n,a,i,r,s,o,l=this.DOM.dropdown,c=e.placeAbove,d=e.appendTarget===document.body,u=d?window.pageYOffset:e.appendTarget.scrollTop,h=document.fullscreenElement||document.webkitFullscreenElement||document.documentElement,p=h.clientHeight,m=Math.max(h.clientWidth||0,window.innerWidth||0)>480?e.position:"all",g=this.DOM["input"==m?"input":"scope"];if(t=t||l.clientHeight,this.state.dropdown.visible){if("text"==m?(i=(n=function(){const t=document.getSelection();if(t.rangeCount){const e=t.getRangeAt(0),n=e.startContainer,a=e.startOffset;let i,r;if(a>0)return r=document.createRange(),r.setStart(n,a-1),r.setEnd(n,a),i=r.getBoundingClientRect(),{left:i.right,top:i.top,bottom:i.bottom};if(n.getBoundingClientRect)return n.getBoundingClientRect()}return{left:-9999,top:-9999}}()).bottom,a=n.top,r=n.left,s="auto"):(o=function(t){for(var e=0,n=0;t&&t!=h;)e+=t.offsetLeft||0,n+=t.offsetTop||0,t=t.parentNode;return{left:e,top:n}}(e.appendTarget),a=(n=g.getBoundingClientRect()).top-o.top,i=n.bottom-1-o.top,r=n.left-o.left,s=n.width+"px"),!d){let t=function(){for(var t=0,n=e.appendTarget.parentNode;n;)t+=n.scrollTop||0,n=n.parentNode;return t}();a+=t,i+=t}a=Math.floor(a),i=Math.ceil(i),c=void 0===c?p-n.bottom<t:c,l.style.cssText="left:"+(r+window.pageXOffset)+"px; width:"+s+";"+(c?"top: "+(a+u)+"px":"top: "+(i+u)+"px"),l.setAttribute("placement",c?"top":"bottom"),l.setAttribute("position",m)}}},events:{binding(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];var e=this.dropdown.events.callbacks,n=this.listeners.dropdown=this.listeners.dropdown||{position:this.dropdown.position.bind(this,null),onKeyDown:e.onKeyDown.bind(this),onMouseOver:e.onMouseOver.bind(this),onMouseLeave:e.onMouseLeave.bind(this),onClick:e.onClick.bind(this),onScroll:e.onScroll.bind(this)},a=t?"addEventListener":"removeEventListener";"manual"!=this.settings.dropdown.position&&(document[a]("scroll",n.position,!0),window[a]("resize",n.position),window[a]("keydown",n.onKeyDown)),this.DOM.dropdown[a]("mouseover",n.onMouseOver),this.DOM.dropdown[a]("mouseleave",n.onMouseLeave),this.DOM.dropdown[a]("mousedown",n.onClick),this.DOM.dropdown.content[a]("scroll",n.onScroll)},callbacks:{onKeyDown(t){if(this.state.hasFocus&&!this.state.composing){var e=this.DOM.dropdown.querySelector(this.settings.classNames.dropdownItemActiveSelector),n=this.dropdown.getSuggestionDataByNode(e);switch(t.key){case"ArrowDown":case"ArrowUp":case"Down":case"Up":t.preventDefault();var a=this.dropdown.getAllSuggestionsRefs(),i="ArrowUp"==t.key||"Up"==t.key;e&&(e=this.dropdown.getNextOrPrevOption(e,!i)),e&&e.matches(this.settings.classNames.dropdownItemSelector)||(e=a[i?a.length-1:0]),this.dropdown.highlightOption(e,!0);break;case"Escape":case"Esc":this.dropdown.hide();break;case"ArrowRight":if(this.state.actions.ArrowLeft)return;case"Tab":if("mix"!=this.settings.mode&&e&&!this.settings.autoComplete.rightKey&&!this.state.editing){t.preventDefault();var r=this.dropdown.getMappedValue(n);return this.input.autocomplete.set.call(this,r),!1}return!0;case"Enter":t.preventDefault(),this.settings.hooks.suggestionClick(t,{tagify:this,tagData:n,suggestionElm:e}).then((()=>{if(e)return this.dropdown.selectOption(e),e=this.dropdown.getNextOrPrevOption(e,!i),void this.dropdown.highlightOption(e);this.dropdown.hide(),"mix"!=this.settings.mode&&this.addTags(this.state.inputText.trim(),!0)})).catch((t=>t));break;case"Backspace":{if("mix"==this.settings.mode||this.state.editing.scope)return;const t=this.input.raw.call(this);""!=t&&8203!=t.charCodeAt(0)||(!0===this.settings.backspace?this.removeTags():"edit"==this.settings.backspace&&setTimeout(this.editTag.bind(this),0))}}}},onMouseOver(t){var e=t.target.closest(this.settings.classNames.dropdownItemSelector);e&&this.dropdown.highlightOption(e)},onMouseLeave(t){this.dropdown.highlightOption()},onClick(t){if(0==t.button&&t.target!=this.DOM.dropdown&&t.target!=this.DOM.dropdown.content){var e=t.target.closest(this.settings.classNames.dropdownItemSelector),n=this.dropdown.getSuggestionDataByNode(e);this.state.actions.selectOption=!0,setTimeout((()=>this.state.actions.selectOption=!1),50),this.settings.hooks.suggestionClick(t,{tagify:this,tagData:n,suggestionElm:e}).then((()=>{e?this.dropdown.selectOption(e,t):this.dropdown.hide()})).catch((t=>console.warn(t)))}},onScroll(t){var e=t.target,n=e.scrollTop/(e.scrollHeight-e.parentNode.clientHeight)*100;this.trigger("dropdown:scroll",{percentage:Math.round(n)})}}},getSuggestionDataByNode(t){var e=t&&t.getAttribute("value");return this.suggestedListItems.find((t=>t.value==e))||null},getNextOrPrevOption(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];var n=this.dropdown.getAllSuggestionsRefs(),a=n.findIndex((e=>e===t));return e?n[a+1]:n[a-1]},highlightOption(t,e){var n,a=this.settings.classNames.dropdownItemActive;if(this.state.ddItemElm&&(this.state.ddItemElm.classList.remove(a),this.state.ddItemElm.removeAttribute("aria-selected")),!t)return this.state.ddItemData=null,this.state.ddItemElm=null,void this.input.autocomplete.suggest.call(this);n=this.dropdown.getSuggestionDataByNode(t),this.state.ddItemData=n,this.state.ddItemElm=t,t.classList.add(a),t.setAttribute("aria-selected",!0),e&&(t.parentNode.scrollTop=t.clientHeight+t.offsetTop-t.parentNode.clientHeight),this.settings.autoComplete&&(this.input.autocomplete.suggest.call(this,n),this.dropdown.position())},selectOption(t,e){var n=this.settings.dropdown,a=n.clearOnSelect,i=n.closeOnSelect;if(!t)return this.addTags(this.state.inputText,!0),void(i&&this.dropdown.hide());e=e||{};var r=t.getAttribute("value"),s="noMatch"==r,o=this.suggestedListItems.find((t=>(t.value??t)==r));this.trigger("dropdown:select",{data:o,elm:t,event:e}),r&&(o||s)?(this.state.editing?this.onEditTagDone(null,u({__isValid:!0},this.normalizeTags([o])[0])):this["mix"==this.settings.mode?"addMixTags":"addTags"]([o||this.input.raw.call(this)],a),this.DOM.input.parentNode&&(setTimeout((()=>{this.DOM.input.focus(),this.toggleFocusClass(!0)})),i&&setTimeout(this.dropdown.hide.bind(this)),t.addEventListener("transitionend",(()=>{this.dropdown.fillHeaderFooter(),setTimeout((()=>t.remove()),100)}),{once:!0}),t.classList.add(this.settings.classNames.dropdownItemHidden))):i&&setTimeout(this.dropdown.hide.bind(this))},selectAll(t){this.suggestedListItems.length=0,this.dropdown.hide(),this.dropdown.filterListItems("");var e=this.dropdown.filterListItems("");return t||(e=this.state.dropdown.suggestions),this.addTags(e,!0),this},filterListItems(t,e){var n,a,i,r,s,o=this.settings,l=o.dropdown,c=(e=e||{},[]),u=[],h=o.whitelist,m=l.maxItems>=0?l.maxItems:1/0,g=l.searchKeys,f=0;if(!(t="select"==o.mode&&this.value.length&&this.value[0][o.tagTextProp]==t?"":t)||!g.length)return c=l.includeSelectedTags?h:h.filter((t=>!this.isTagDuplicate(d(t)?t.value:t))),this.state.dropdown.suggestions=c,c.slice(0,m);function v(t,e){return e.toLowerCase().split(" ").every((e=>t.includes(e.toLowerCase())))}for(s=l.caseSensitive?""+t:(""+t).toLowerCase();f<h.length;f++){let t,o;n=h[f]instanceof Object?h[f]:{value:h[f]};let m=Object.keys(n).some((t=>g.includes(t)))?g:["value"];l.fuzzySearch&&!e.exact?(i=m.reduce(((t,e)=>t+" "+(n[e]||"")),"").toLowerCase().trim(),l.accentedSearch&&(i=p(i),s=p(s)),t=0==i.indexOf(s),o=i===s,a=v(i,s)):(t=!0,a=m.some((t=>{var a=""+(n[t]||"");return l.accentedSearch&&(a=p(a),s=p(s)),l.caseSensitive||(a=a.toLowerCase()),o=a===s,e.exact?a===s:0==a.indexOf(s)}))),r=!l.includeSelectedTags&&this.isTagDuplicate(d(n)?n.value:n),a&&!r&&(o&&t?u.push(n):"startsWith"==l.sortby&&t?c.unshift(n):c.push(n))}return this.state.dropdown.suggestions=u.concat(c),"function"==typeof l.sortby?l.sortby(u.concat(c),s):u.concat(c).slice(0,m)},getMappedValue(t){var e=this.settings.dropdown.mapValueTo;return e?"function"==typeof e?e(t):t[e]||t.value:t.value},createListHTML(t){return u([],t).map(((t,n)=>{"string"!=typeof t&&"number"!=typeof t||(t={value:t});var a=this.dropdown.getMappedValue(t);return a="string"==typeof a?c(a):a,this.settings.templates.dropdownItem.apply(this,[e(e({},t),{},{mappedValue:a}),this])})).join("")}};const T="@yaireo/tagify/";var _,E={empty:"empty",exceed:"number of tags exceeded",pattern:"pattern mismatch",duplicate:"already exists",notAllowed:"not allowed"},O={wrapper:(t,e)=>`<tags class="${e.classNames.namespace} ${e.mode?`${e.classNames[e.mode+"Mode"]}`:""} ${t.className}"\n                    ${e.readonly?"readonly":""}\n                    ${e.disabled?"disabled":""}\n                    ${e.required?"required":""}\n                    ${"select"===e.mode?"spellcheck='false'":""}\n                    tabIndex="-1">\n            <span ${!e.readonly&&e.userInput?"contenteditable":""} tabIndex="0" data-placeholder="${e.placeholder||"&#8203;"}" aria-placeholder="${e.placeholder||""}"\n                class="${e.classNames.input}"\n                role="textbox"\n                aria-autocomplete="both"\n                aria-multiline="${"mix"==e.mode}"></span>\n                &#8203;\n        </tags>`,tag(t,e){let n=e.settings;return`<tag title="${t.title||t.value}"\n                    contenteditable='false'\n                    spellcheck='false'\n                    tabIndex="${n.a11y.focusableTags?0:-1}"\n                    class="${n.classNames.tag} ${t.class||""}"\n                    ${this.getAttributes(t)}>\n            <x title='' class="${n.classNames.tagX}" role='button' aria-label='remove tag'></x>\n            <div>\n                <span class="${n.classNames.tagText}">${t[n.tagTextProp]||t.value}</span>\n            </div>\n        </tag>`},dropdown(t){var e=t.dropdown,n="manual"==e.position,a=`${t.classNames.dropdown}`;return`<div class="${n?"":a} ${e.classname}" role="listbox" aria-labelledby="dropdown">\n                    <div data-selector='tagify-suggestions-wrapper' class="${t.classNames.dropdownWrapper}"></div>\n                </div>`},dropdownContent(t){var e=this.settings,n=this.state.dropdown.suggestions;return`\n            ${e.templates.dropdownHeader.call(this,n)}\n            ${t}\n            ${e.templates.dropdownFooter.call(this,n)}\n        `},dropdownItem(t){return`<div ${this.getAttributes(t)}\n                    class='${this.settings.classNames.dropdownItem} ${t.class?t.class:""}'\n                    tabindex="0"\n                    role="option">${t.mappedValue||t.value}</div>`},dropdownHeader(t){return`<header data-selector='tagify-suggestions-header' class="${this.settings.classNames.dropdownHeader}"></header>`},dropdownFooter(t){var e=t.length-this.settings.dropdown.maxItems;return e>0?`<footer data-selector='tagify-suggestions-footer' class="${this.settings.classNames.dropdownFooter}">\n                ${e} more items. Refine your search.\n            </footer>`:""},dropdownItemNoMatch:null},S={customBinding(){this.customEventsList.forEach((t=>{this.on(t,this.settings.callbacks[t])}))},binding(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];var e,n=this.events.callbacks,a=t?"addEventListener":"removeEventListener";if(!this.state.mainEvents||!t){for(var i in this.state.mainEvents=t,t&&!this.listeners.main&&(this.events.bindGlobal.call(this),this.settings.isJQueryPlugin&&jQuery(this.DOM.originalInput).on("tagify.removeAllTags",this.removeAllTags.bind(this))),e=this.listeners.main=this.listeners.main||{focus:["input",n.onFocusBlur.bind(this)],keydown:["input",n.onKeydown.bind(this)],click:["scope",n.onClickScope.bind(this)],dblclick:["scope",n.onDoubleClickScope.bind(this)],paste:["input",n.onPaste.bind(this)],drop:["input",n.onDrop.bind(this)],compositionstart:["input",n.onCompositionStart.bind(this)],compositionend:["input",n.onCompositionEnd.bind(this)]})this.DOM[e[i][0]][a](i,e[i][1]);clearInterval(this.listeners.main.originalInputValueObserverInterval),this.listeners.main.originalInputValueObserverInterval=setInterval(n.observeOriginalInputValue.bind(this),500);var r=this.listeners.main.inputMutationObserver||new MutationObserver(n.onInputDOMChange.bind(this));r.disconnect(),"mix"==this.settings.mode&&r.observe(this.DOM.input,{childList:!0})}},bindGlobal(t){var e,n=this.events.callbacks,a=t?"removeEventListener":"addEventListener";if(this.listeners&&(t||!this.listeners.global))for(e of(this.listeners.global=this.listeners.global||[{type:this.isIE?"keydown":"input",target:this.DOM.input,cb:n[this.isIE?"onInputIE":"onInput"].bind(this)},{type:"keydown",target:window,cb:n.onWindowKeyDown.bind(this)},{type:"blur",target:this.DOM.input,cb:n.onFocusBlur.bind(this)},{type:"click",target:document,cb:n.onClickAnywhere.bind(this)}],this.listeners.global))e.target[a](e.type,e.cb)},unbindGlobal(){this.events.bindGlobal.call(this,!0)},callbacks:{onFocusBlur(t){var e=this.settings,n=t.target?this.trim(t.target.textContent):"",a=this.value?.[0]?.[e.tagTextProp],i=t.type,r=e.dropdown.enabled>=0,s={relatedTarget:t.relatedTarget},o=this.state.actions.selectOption&&(r||!e.dropdown.closeOnSelect),l=this.state.actions.addNew&&r,c=t.relatedTarget&&f.call(this,t.relatedTarget)&&this.DOM.scope.contains(t.relatedTarget);if("blur"==i){if(t.relatedTarget===this.DOM.scope)return this.dropdown.hide(),void this.DOM.input.focus();this.postUpdate(),e.onChangeAfterBlur&&this.triggerChangeEvent()}if(!o&&!l)if(this.state.hasFocus="focus"==i&&+new Date,this.toggleFocusClass(this.state.hasFocus),"mix"!=e.mode){if("focus"==i)return this.trigger("focus",s),void(0!==e.dropdown.enabled&&e.userInput||this.dropdown.show(this.value.length?"":void 0));"blur"==i&&(this.trigger("blur",s),this.loading(!1),"select"==e.mode&&(c&&(this.removeTags(),n=""),a===n&&(n="")),n&&!this.state.actions.selectOption&&e.addTagOnBlur&&this.addTags(n,!0)),this.DOM.input.removeAttribute("style"),this.dropdown.hide()}else"focus"==i?this.trigger("focus",s):"blur"==t.type&&(this.trigger("blur",s),this.loading(!1),this.dropdown.hide(),this.state.dropdown.visible=void 0,this.setStateSelection())},onCompositionStart(t){this.state.composing=!0},onCompositionEnd(t){this.state.composing=!1},onWindowKeyDown(t){var e,n=document.activeElement,a=f.call(this,n)&&this.DOM.scope.contains(document.activeElement),i=a&&n.hasAttribute("readonly");if(a&&!i)switch(e=n.nextElementSibling,t.key){case"Backspace":this.settings.readonly||(this.removeTags(n),(e||this.DOM.input).focus());break;case"Enter":setTimeout(this.editTag.bind(this),0,n)}},onKeydown(t){var e=this.settings;if(!this.state.composing&&e.userInput){"select"==e.mode&&e.enforceWhitelist&&this.value.length&&"Tab"!=t.key&&t.preventDefault();var n=this.trim(t.target.textContent);if(this.trigger("keydown",{event:t}),"mix"==e.mode){switch(t.key){case"Left":case"ArrowLeft":this.state.actions.ArrowLeft=!0;break;case"Delete":case"Backspace":if(this.state.editing)return;var a=document.getSelection(),i="Delete"==t.key&&a.anchorOffset==(a.anchorNode.length||0),r=a.anchorNode.previousSibling,o=1==a.anchorNode.nodeType||!a.anchorOffset&&r&&1==r.nodeType&&a.anchorNode.previousSibling;s(this.DOM.input.innerHTML);var c,d,u,h=this.getTagElms();if("edit"==e.backspace&&o)return c=1==a.anchorNode.nodeType?null:a.anchorNode.previousElementSibling,setTimeout(this.editTag.bind(this),0,c),void t.preventDefault();if(m()&&o instanceof Element)return u=l(o),o.hasAttribute("readonly")||o.remove(),this.DOM.input.focus(),void setTimeout((()=>{this.placeCaretAfterNode(u),this.DOM.input.click()}));if("BR"==a.anchorNode.nodeName)return;if((i||o)&&1==a.anchorNode.nodeType?d=0==a.anchorOffset?i?h[0]:null:h[Math.min(h.length,a.anchorOffset)-1]:i?d=a.anchorNode.nextElementSibling:o instanceof Element&&(d=o),3==a.anchorNode.nodeType&&!a.anchorNode.nodeValue&&a.anchorNode.previousElementSibling&&t.preventDefault(),(o||i)&&!e.backspace)return void t.preventDefault();if("Range"!=a.type&&!a.anchorOffset&&a.anchorNode==this.DOM.input&&"Delete"!=t.key)return void t.preventDefault();if("Range"!=a.type&&d&&d.hasAttribute("readonly"))return void this.placeCaretAfterNode(l(d));clearTimeout(_),_=setTimeout((()=>{var t=document.getSelection();s(this.DOM.input.innerHTML),!i&&t.anchorNode.previousSibling,this.value=[].map.call(h,((t,e)=>{var n=y(t);if(t.parentNode||n.readonly)return n;this.trigger("remove",{tag:t,index:e,data:n})})).filter((t=>t))}),20)}return!0}switch(t.key){case"Backspace":"select"==e.mode&&e.enforceWhitelist&&this.value.length?this.removeTags():this.state.dropdown.visible&&"manual"!=e.dropdown.position||""!=t.target.textContent&&8203!=n.charCodeAt(0)||(!0===e.backspace?this.removeTags():"edit"==e.backspace&&setTimeout(this.editTag.bind(this),0));break;case"Esc":case"Escape":if(this.state.dropdown.visible)return;t.target.blur();break;case"Down":case"ArrowDown":this.state.dropdown.visible||this.dropdown.show();break;case"ArrowRight":{let t=this.state.inputSuggestion||this.state.ddItemData;if(t&&e.autoComplete.rightKey)return void this.addTags([t],!0);break}case"Tab":{let a="select"==e.mode;if(!n||a)return!0;t.preventDefault()}case"Enter":if(this.state.dropdown.visible&&"manual"!=e.dropdown.position)return;t.preventDefault(),setTimeout((()=>{this.state.dropdown.visible||this.state.actions.selectOption||this.addTags(n,!0)}))}}},onInput(t){this.postUpdate();var e=this.settings;if("mix"==e.mode)return this.events.callbacks.onMixTagsInput.call(this,t);var n=this.input.normalize.call(this),a=n.length>=e.dropdown.enabled,i={value:n,inputElm:this.DOM.input},r=this.validateTag({value:n});"select"==e.mode&&this.toggleScopeValidation(r),i.isValid=r,this.state.inputText!=n&&(this.input.set.call(this,n,!1),-1!=n.search(e.delimiters)?this.addTags(n)&&this.input.set.call(this):e.dropdown.enabled>=0&&this.dropdown[a?"show":"hide"](n),this.trigger("input",i))},onMixTagsInput(t){var e,n,a,i,r,s,o,l,c=this.settings,d=this.value.length,h=this.getTagElms(),p=document.createDocumentFragment(),g=window.getSelection().getRangeAt(0),f=[].map.call(h,(t=>y(t).value));if("deleteContentBackward"==t.inputType&&m()&&this.events.callbacks.onKeydown.call(this,{target:t.target,key:"Backspace"}),this.value.slice().forEach((t=>{t.readonly&&!f.includes(t.value)&&p.appendChild(this.createTagElem(t))})),p.childNodes.length&&(g.insertNode(p),this.setRangeAtStartEnd(!1,p.lastChild)),h.length!=d)return this.value=[].map.call(this.getTagElms(),(t=>y(t))),void this.update({withoutChangeEvent:!0});if(this.hasMaxTags())return!0;if(window.getSelection&&(s=window.getSelection()).rangeCount>0&&3==s.anchorNode.nodeType){if((g=s.getRangeAt(0).cloneRange()).collapse(!0),g.setStart(s.focusNode,0),a=(e=g.toString().slice(0,g.endOffset)).split(c.pattern).length-1,(n=e.match(c.pattern))&&(i=e.slice(e.lastIndexOf(n[n.length-1]))),i){if(this.state.actions.ArrowLeft=!1,this.state.tag={prefix:i.match(c.pattern)[0],value:i.replace(c.pattern,"")},this.state.tag.baseOffset=s.baseOffset-this.state.tag.value.length,l=this.state.tag.value.match(c.delimiters))return this.state.tag.value=this.state.tag.value.replace(c.delimiters,""),this.state.tag.delimiters=l[0],this.addTags(this.state.tag.value,c.dropdown.clearOnSelect),void this.dropdown.hide();r=this.state.tag.value.length>=c.dropdown.enabled;try{o=(o=this.state.flaggedTags[this.state.tag.baseOffset]).prefix==this.state.tag.prefix&&o.value[0]==this.state.tag.value[0],this.state.flaggedTags[this.state.tag.baseOffset]&&!this.state.tag.value&&delete this.state.flaggedTags[this.state.tag.baseOffset]}catch(t){}(o||a<this.state.mixMode.matchedPatternCount)&&(r=!1)}else this.state.flaggedTags={};this.state.mixMode.matchedPatternCount=a}setTimeout((()=>{this.update({withoutChangeEvent:!0}),this.trigger("input",u({},this.state.tag,{textContent:this.DOM.input.textContent})),this.state.tag&&this.dropdown[r?"show":"hide"](this.state.tag.value)}),10)},onInputIE(t){var e=this;setTimeout((function(){e.events.callbacks.onInput.call(e,t)}))},observeOriginalInputValue(){this.DOM.originalInput.parentNode||this.destroy(),this.DOM.originalInput.value!=this.DOM.originalInput.tagifyValue&&this.loadOriginalValues()},onClickAnywhere(t){t.target==this.DOM.scope||this.DOM.scope.contains(t.target)||(this.toggleFocusClass(!1),this.state.hasFocus=!1)},onClickScope(t){var e=this.settings,n=t.target.closest("."+e.classNames.tag),a=+new Date-this.state.hasFocus;if(t.target!=this.DOM.scope){if(!t.target.classList.contains(e.classNames.tagX))return n?(this.trigger("click",{tag:n,index:this.getNodeIndex(n),data:y(n),event:t}),void(1!==e.editTags&&1!==e.editTags.clicks||this.events.callbacks.onDoubleClickScope.call(this,t))):void(t.target==this.DOM.input&&("mix"==e.mode&&this.fixFirefoxLastTagNoCaret(),a>500)?this.state.dropdown.visible?this.dropdown.hide():0===e.dropdown.enabled&&"mix"!=e.mode&&this.dropdown.show(this.value.length?"":void 0):"select"!=e.mode||0!==e.dropdown.enabled||this.state.dropdown.visible||this.dropdown.show());this.removeTags(t.target.parentNode)}else this.DOM.input.focus()},onPaste(t){t.preventDefault();var e,n,a=this.settings;if("select"==a.mode&&a.enforceWhitelist||!a.userInput)return!1;a.readonly||(e=t.clipboardData||window.clipboardData,n=e.getData("Text"),a.hooks.beforePaste(t,{tagify:this,pastedText:n,clipboardData:e}).then((e=>{void 0===e&&(e=n),e&&(this.injectAtCaret(e,window.getSelection().getRangeAt(0)),"mix"==this.settings.mode?this.events.callbacks.onMixTagsInput.call(this,t):this.settings.pasteAsTags?this.addTags(this.state.inputText+e,!0):this.state.inputText=e)})).catch((t=>t)))},onDrop(t){t.preventDefault()},onEditTagInput(t,e){var n=t.closest("."+this.settings.classNames.tag),a=this.getNodeIndex(n),i=y(n),r=this.input.normalize.call(this,t),s={[this.settings.tagTextProp]:r,__tagId:i.__tagId},o=this.validateTag(s);this.editTagChangeDetected(u(i,s))||!0!==t.originalIsValid||(o=!0),n.classList.toggle(this.settings.classNames.tagInvalid,!0!==o),i.__isValid=o,n.title=!0===o?i.title||i.value:o,r.length>=this.settings.dropdown.enabled&&(this.state.editing&&(this.state.editing.value=r),this.dropdown.show(r)),this.trigger("edit:input",{tag:n,index:a,data:u({},this.value[a],{newValue:r}),event:e})},onEditTagPaste(t,e){var n=(e.clipboardData||window.clipboardData).getData("Text");e.preventDefault();var a=v(n);this.setRangeAtStartEnd(!1,a)},onEditTagFocus(t){this.state.editing={scope:t,input:t.querySelector("[contenteditable]")}},onEditTagBlur(t){if(this.state.hasFocus||this.toggleFocusClass(),this.DOM.scope.contains(t)){var e,n,a=this.settings,i=t.closest("."+a.classNames.tag),r=y(i),s=this.input.normalize.call(this,t),o={[a.tagTextProp]:s,__tagId:r.__tagId},l=r.__originalData,c=this.editTagChangeDetected(u(r,o)),d=this.validateTag(o);if(s)if(c){if(e=this.hasMaxTags(),n=u({},l,{[a.tagTextProp]:this.trim(s),__isValid:d}),a.transformTag.call(this,n,l),!0!==(d=(!e||!0===l.__isValid)&&this.validateTag(n))){if(this.trigger("invalid",{data:n,tag:i,message:d}),a.editTags.keepInvalid)return;a.keepInvalidTags?n.__isValid=d:n=l}else a.keepInvalidTags&&(delete n.title,delete n["aria-invalid"],delete n.class);this.onEditTagDone(i,n)}else this.onEditTagDone(i,l);else this.onEditTagDone(i)}},onEditTagkeydown(t,e){if(!this.state.composing)switch(this.trigger("edit:keydown",{event:t}),t.key){case"Esc":case"Escape":e.parentNode.replaceChild(e.__tagifyTagData.__originalHTML,e),this.state.editing=!1;case"Enter":case"Tab":t.preventDefault(),t.target.blur()}},onDoubleClickScope(t){var e,n,a=t.target.closest("."+this.settings.classNames.tag),i=y(a),r=this.settings;a&&r.userInput&&!1!==i.editable&&(e=a.classList.contains(this.settings.classNames.tagEditing),n=a.hasAttribute("readonly"),"select"==r.mode||r.readonly||e||n||!this.settings.editTags||this.editTag(a),this.toggleFocusClass(!0),this.trigger("dblclick",{tag:a,index:this.getNodeIndex(a),data:y(a)}))},onInputDOMChange(t){t.forEach((t=>{t.addedNodes.forEach((t=>{if("<div><br></div>"==t.outerHTML)t.replaceWith(document.createElement("br"));else if(1==t.nodeType&&t.querySelector(this.settings.classNames.tagSelector)){let e=document.createTextNode("");3==t.childNodes[0].nodeType&&"BR"!=t.previousSibling.nodeName&&(e=document.createTextNode("\n")),t.replaceWith(e,...[...t.childNodes].slice(0,-1)),this.placeCaretAfterNode(e)}else if(f.call(this,t)&&(3!=t.previousSibling?.nodeType||t.previousSibling.textContent||t.previousSibling.remove(),t.previousSibling&&"BR"==t.previousSibling.nodeName)){t.previousSibling.replaceWith("\nâ");let e=t.nextSibling,n="";for(;e;)n+=e.textContent,e=e.nextSibling;n.trim()&&this.placeCaretAfterNode(t.previousSibling)}})),t.removedNodes.forEach((t=>{t&&"BR"==t.nodeName&&f.call(this,e)&&(this.removeTags(e),this.fixFirefoxLastTagNoCaret())}))}));var e=this.DOM.input.lastChild;e&&""==e.nodeValue&&e.remove(),e&&"BR"==e.nodeName||this.DOM.input.appendChild(document.createElement("br"))}}};function C(t,e){if(!t){console.warn("Tagify:","input element not found",t);const e=new Proxy(this,{get:()=>()=>e});return e}if(t.__tagify)return console.warn("Tagify: ","input element is already Tagified - Same instance is returned.",t),t.__tagify;var n;u(this,function(t){var e=document.createTextNode("");function n(t,n,a){a&&n.split(/\s+/g).forEach((n=>e[t+"EventListener"].call(e,n,a)))}return{off(t,e){return n("remove",t,e),this},on(t,e){return e&&"function"==typeof e&&n("add",t,e),this},trigger(n,a,i){var r;if(i=i||{cloneData:!0},n)if(t.settings.isJQueryPlugin)"remove"==n&&(n="removeTag"),jQuery(t.DOM.originalInput).triggerHandler(n,[a]);else{try{var s="object"==typeof a?a:{value:a};if((s=i.cloneData?u({},s):s).tagify=this,a.event&&(s.event=this.cloneEvent(a.event)),a instanceof Object)for(var o in a)a[o]instanceof HTMLElement&&(s[o]=a[o]);r=new CustomEvent(n,{detail:s})}catch(t){console.warn(t)}e.dispatchEvent(r)}}}}(this)),this.isFirefox=/firefox|fxios/i.test(navigator.userAgent)&&!/seamonkey/i.test(navigator.userAgent),this.isIE=window.document.documentMode,e=e||{},this.getPersistedData=(n=e.id,t=>{let e,a="/"+t;if(1==localStorage.getItem(T+n+"/v",1))try{e=JSON.parse(localStorage[T+n+a])}catch(t){}return e}),this.setPersistedData=(t=>t?(localStorage.setItem(T+t+"/v",1),(e,n)=>{let a="/"+n,i=JSON.stringify(e);e&&n&&(localStorage.setItem(T+t+a,i),dispatchEvent(new Event("storage")))}):()=>{})(e.id),this.clearPersistedData=(t=>e=>{const n=T+"/"+t+"/";if(e)localStorage.removeItem(n+e);else for(let t in localStorage)t.includes(n)&&localStorage.removeItem(t)})(e.id),this.applySettings(t,e),this.state={inputText:"",editing:!1,composing:!1,actions:{},mixMode:{},dropdown:{},flaggedTags:{}},this.value=[],this.listeners={},this.DOM={},this.build(t),b.call(this),this.getCSSVars(),this.loadOriginalValues(),this.events.customBinding.call(this),this.events.binding.call(this),t.autofocus&&this.DOM.input.focus(),t.__tagify=this}return C.prototype={_dropdown:k,getSetTagData:y,helpers:{sameStr:a,removeCollectionProp:i,omit:r,isObject:d,parseHTML:o,escapeHTML:c,extend:u,concatWithoutDups:h,getUID:g,isNodeTag:f},customEventsList:["change","add","remove","invalid","input","click","keydown","focus","blur","edit:input","edit:beforeUpdate","edit:updated","edit:start","edit:keydown","dropdown:show","dropdown:hide","dropdown:select","dropdown:updated","dropdown:noMatch","dropdown:scroll"],dataProps:["__isValid","__removed","__originalData","__originalHTML","__tagId"],trim(t){return this.settings.trim&&t&&"string"==typeof t?t.trim():t},parseHTML:o,templates:O,parseTemplate(t,e){return o((t=this.settings.templates[t]||t).apply(this,e))},set whitelist(t){const e=t&&Array.isArray(t);this.settings.whitelist=e?t:[],this.setPersistedData(e?t:[],"whitelist")},get whitelist(){return this.settings.whitelist},generateClassSelectors(t){for(let e in t){let n=e;Object.defineProperty(t,n+"Selector",{get(){return"."+this[n].split(" ")[0]}})}},applySettings(t,n){w.templates=this.templates;var a=u({},w,"mix"==n.mode?{dropdown:{position:"text"}}:{}),i=this.settings=u({},a,n);if(i.disabled=t.hasAttribute("disabled"),i.readonly=i.readonly||t.hasAttribute("readonly"),i.placeholder=c(t.getAttribute("placeholder")||i.placeholder||""),i.required=t.hasAttribute("required"),this.generateClassSelectors(i.classNames),void 0===i.dropdown.includeSelectedTags&&(i.dropdown.includeSelectedTags=i.duplicates),this.isIE&&(i.autoComplete=!1),["whitelist","blacklist"].forEach((e=>{var n=t.getAttribute("data-"+e);n&&(n=n.split(i.delimiters))instanceof Array&&(i[e]=n)})),"autoComplete"in n&&!d(n.autoComplete)&&(i.autoComplete=w.autoComplete,i.autoComplete.enabled=n.autoComplete),"mix"==i.mode&&(i.pattern=i.pattern||/@/,i.autoComplete.rightKey=!0,i.delimiters=n.delimiters||null,i.tagTextProp&&!i.dropdown.searchKeys.includes(i.tagTextProp)&&i.dropdown.searchKeys.push(i.tagTextProp)),t.pattern)try{i.pattern=new RegExp(t.pattern)}catch(t){}if(i.delimiters){i._delimiters=i.delimiters;try{i.delimiters=new RegExp(this.settings.delimiters,"g")}catch(t){}}i.disabled&&(i.userInput=!1),this.TEXTS=e(e({},E),i.texts||{}),("select"!=i.mode||n.dropdown?.enabled)&&i.userInput||(i.dropdown.enabled=0),i.dropdown.appendTarget=n.dropdown?.appendTarget||document.body;let r=this.getPersistedData("whitelist");Array.isArray(r)&&(this.whitelist=Array.isArray(i.whitelist)?h(i.whitelist,r):r)},getAttributes(t){var e,n=this.getCustomAttributes(t),a="";for(e in n)a+=" "+e+(void 0!==t[e]?`="${n[e]}"`:"");return a},getCustomAttributes(t){if(!d(t))return"";var e,n={};for(e in t)"__"!=e.slice(0,2)&&"class"!=e&&t.hasOwnProperty(e)&&void 0!==t[e]&&(n[e]=c(t[e]));return n},setStateSelection(){var t=window.getSelection(),e={anchorOffset:t.anchorOffset,anchorNode:t.anchorNode,range:t.getRangeAt&&t.rangeCount&&t.getRangeAt(0)};return this.state.selection=e,e},getCSSVars(){var t,e=getComputedStyle(this.DOM.scope,null);this.CSSVars={tagHideTransition:(t=>{let e=t.value;return"s"==t.unit?1e3*e:e})(function(t){if(!t)return{};var e=(t=t.trim().split(" ")[0]).split(/\d+/g).filter((t=>t)).pop().trim();return{value:+t.split(e).filter((t=>t))[0].trim(),unit:e}}((t="tag-hide-transition",e.getPropertyValue("--"+t))))}},build(t){var e=this.DOM;this.settings.mixMode.integrated?(e.originalInput=null,e.scope=t,e.input=t):(e.originalInput=t,e.originalInput_tabIndex=t.tabIndex,e.scope=this.parseTemplate("wrapper",[t,this.settings]),e.input=e.scope.querySelector(this.settings.classNames.inputSelector),t.parentNode.insertBefore(e.scope,t),t.tabIndex=-1)},destroy(){this.events.unbindGlobal.call(this),this.DOM.scope.parentNode.removeChild(this.DOM.scope),this.DOM.originalInput.tabIndex=this.DOM.originalInput_tabIndex,delete this.DOM.originalInput.__tagify,this.dropdown.hide(!0),clearTimeout(this.dropdownHide__bindEventsTimeout),clearInterval(this.listeners.main.originalInputValueObserverInterval)},loadOriginalValues(t){var e,n=this.settings;if(this.state.blockChangeEvent=!0,void 0===t){const e=this.getPersistedData("value");t=e&&!this.DOM.originalInput.value?e:n.mixMode.integrated?this.DOM.input.textContent:this.DOM.originalInput.value}if(this.removeAllTags(),t)if("mix"==n.mode)this.parseMixTags(t),(e=this.DOM.input.lastChild)&&"BR"==e.tagName||this.DOM.input.insertAdjacentHTML("beforeend","<br>");else{try{JSON.parse(t)instanceof Array&&(t=JSON.parse(t))}catch(t){}this.addTags(t,!0).forEach((t=>t&&t.classList.add(n.classNames.tagNoAnimation)))}else this.postUpdate();this.state.lastOriginalValueReported=n.mixMode.integrated?"":this.DOM.originalInput.value},cloneEvent(t){var e={};for(var n in t)"path"!=n&&(e[n]=t[n]);return e},loading(t){return this.state.isLoading=t,this.DOM.scope.classList[t?"add":"remove"](this.settings.classNames.scopeLoading),this},tagLoading(t,e){return t&&t.classList[e?"add":"remove"](this.settings.classNames.tagLoading),this},toggleClass(t,e){"string"==typeof t&&this.DOM.scope.classList.toggle(t,e)},toggleScopeValidation(t){var e=!0===t||void 0===t;!this.settings.required&&t&&t===this.TEXTS.empty&&(e=!0),this.toggleClass(this.settings.classNames.tagInvalid,!e),this.DOM.scope.title=e?"":t},toggleFocusClass(t){this.toggleClass(this.settings.classNames.focus,!!t)},triggerChangeEvent:function(){if(!this.settings.mixMode.integrated){var t=this.DOM.originalInput,e=this.state.lastOriginalValueReported!==t.value,n=new CustomEvent("change",{bubbles:!0});e&&(this.state.lastOriginalValueReported=t.value,n.simulated=!0,t._valueTracker&&t._valueTracker.setValue(Math.random()),t.dispatchEvent(n),this.trigger("change",this.state.lastOriginalValueReported),t.value=this.state.lastOriginalValueReported)}},events:S,fixFirefoxLastTagNoCaret(){},setRangeAtStartEnd(t,e){if(e){t="number"==typeof t?t:!!t,e=e.lastChild||e;var n=document.getSelection();if(n.focusNode instanceof Element&&!this.DOM.input.contains(n.focusNode))return!0;try{n.rangeCount>=1&&["Start","End"].forEach((a=>n.getRangeAt(0)["set"+a](e,t||e.length)))}catch(t){}}},placeCaretAfterNode(t){if(t&&t.parentNode){var e=t,n=window.getSelection(),a=n.getRangeAt(0);n.rangeCount&&(a.setStartAfter(e),a.collapse(!0),n.removeAllRanges(),n.addRange(a))}},insertAfterTag(t,e){if(e=e||this.settings.mixMode.insertAfterTag,t&&t.parentNode&&e)return e="string"==typeof e?document.createTextNode(e):e,t.parentNode.insertBefore(e,t.nextSibling),e},editTagChangeDetected(t){var e=t.__originalData;for(var n in e)if(!this.dataProps.includes(n)&&t[n]!=e[n])return!0;return!1},getTagTextNode(t){return t.querySelector(this.settings.classNames.tagTextSelector)},setTagTextNode(t,e){this.getTagTextNode(t).innerHTML=c(e)},editTag(t,e){t=t||this.getLastTag(),e=e||{},this.dropdown.hide();var n=this.settings,a=this.getTagTextNode(t),i=this.getNodeIndex(t),r=y(t),s=this.events.callbacks,o=this,l=!0;if(a){if(!(r instanceof Object&&"editable"in r)||r.editable)return r=y(t,{__originalData:u({},r),__originalHTML:t.cloneNode(!0)}),y(r.__originalHTML,r.__originalData),a.setAttribute("contenteditable",!0),t.classList.add(n.classNames.tagEditing),a.addEventListener("focus",s.onEditTagFocus.bind(this,t)),a.addEventListener("blur",(function(){setTimeout((()=>s.onEditTagBlur.call(o,o.getTagTextNode(t))))})),a.addEventListener("input",s.onEditTagInput.bind(this,a)),a.addEventListener("paste",s.onEditTagPaste.bind(this,a)),a.addEventListener("keydown",(e=>s.onEditTagkeydown.call(this,e,t))),a.addEventListener("compositionstart",s.onCompositionStart.bind(this)),a.addEventListener("compositionend",s.onCompositionEnd.bind(this)),e.skipValidation||(l=this.editTagToggleValidity(t)),a.originalIsValid=l,this.trigger("edit:start",{tag:t,index:i,data:r,isValid:l}),a.focus(),this.setRangeAtStartEnd(!1,a),this}else console.warn("Cannot find element in Tag template: .",n.classNames.tagTextSelector)},editTagToggleValidity(t,e){var n;if(e=e||y(t))return(n=!("__isValid"in e)||!0===e.__isValid)||this.removeTagsFromValue(t),this.update(),t.classList.toggle(this.settings.classNames.tagNotAllowed,!n),e.__isValid;console.warn("tag has no data: ",t,e)},onEditTagDone(t,e){e=e||{};var n={tag:t=t||this.state.editing.scope,index:this.getNodeIndex(t),previousData:y(t),data:e};this.trigger("edit:beforeUpdate",n,{cloneData:!1}),this.state.editing=!1,delete e.__originalData,delete e.__originalHTML,t&&e[this.settings.tagTextProp]?(t=this.replaceTag(t,e),this.editTagToggleValidity(t,e),this.settings.a11y.focusableTags?t.focus():this.placeCaretAfterNode(t)):t&&this.removeTags(t),this.trigger("edit:updated",n),this.dropdown.hide(),this.settings.keepInvalidTags&&this.reCheckInvalidTags()},replaceTag(t,e){e&&e.value||(e=t.__tagifyTagData),e.__isValid&&1!=e.__isValid&&u(e,this.getInvalidTagAttrs(e,e.__isValid));var n=this.createTagElem(e);return t.parentNode.replaceChild(n,t),this.updateValueByDOMTags(),n},updateValueByDOMTags(){this.value.length=0,[].forEach.call(this.getTagElms(),(t=>{t.classList.contains(this.settings.classNames.tagNotAllowed.split(" ")[0])||this.value.push(y(t))})),this.update()},injectAtCaret(t,e){return!(e=e||this.state.selection?.range)&&t?(this.appendMixTags(t),this):(v(t,e),this.setRangeAtStartEnd(!1,t),this.updateValueByDOMTags(),this.update(),this)},input:{set(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];var n=this.settings.dropdown.closeOnSelect;this.state.inputText=t,e&&(this.DOM.input.innerHTML=c(""+t)),!t&&n&&this.dropdown.hide.bind(this),this.input.autocomplete.suggest.call(this),this.input.validate.call(this)},raw(){return this.DOM.input.textContent},validate(){var t=!this.state.inputText||!0===this.validateTag({value:this.state.inputText});return this.DOM.input.classList.toggle(this.settings.classNames.inputInvalid,!t),t},normalize(t){var e=t||this.DOM.input,n=[];e.childNodes.forEach((t=>3==t.nodeType&&n.push(t.nodeValue))),n=n.join("\n");try{n=n.replace(/(?:\r\n|\r|\n)/g,this.settings.delimiters.source.charAt(0))}catch(t){}return n=n.replace(/\s/g," "),this.trim(n)},autocomplete:{suggest(t){if(this.settings.autoComplete.enabled){"string"==typeof(t=t||{value:""})&&(t={value:t});var e=this.dropdown.getMappedValue(t);if("number"!=typeof e){var n=e.substr(0,this.state.inputText.length).toLowerCase(),a=e.substring(this.state.inputText.length);e&&this.state.inputText&&n==this.state.inputText.toLowerCase()?(this.DOM.input.setAttribute("data-suggest",a),this.state.inputSuggestion=t):(this.DOM.input.removeAttribute("data-suggest"),delete this.state.inputSuggestion)}}},set(t){var e=this.DOM.input.getAttribute("data-suggest"),n=t||(e?this.state.inputText+e:null);return!!n&&("mix"==this.settings.mode?this.replaceTextWithNode(document.createTextNode(this.state.tag.prefix+n)):(this.input.set.call(this,n),this.setRangeAtStartEnd(!1,this.DOM.input)),this.input.autocomplete.suggest.call(this),this.dropdown.hide(),!0)}}},getTagIdx(t){return this.value.findIndex((e=>e.__tagId==(t||{}).__tagId))},getNodeIndex(t){var e=0;if(t)for(;t=t.previousElementSibling;)e++;return e},getTagElms(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var a="."+[...this.settings.classNames.tag.split(" "),...e].join(".");return[].slice.call(this.DOM.scope.querySelectorAll(a))},getLastTag(){var t=this.DOM.scope.querySelectorAll(`${this.settings.classNames.tagSelector}:not(.${this.settings.classNames.tagHide}):not([readonly])`);return t[t.length-1]},isTagDuplicate(t,e,n){var i=0;if("select"==this.settings.mode)return!1;for(let r of this.value)a(this.trim(""+t),r.value,e)&&n!=r.__tagId&&i++;return i},getTagIndexByValue(t){var e=[];return this.getTagElms().forEach(((n,i)=>{a(this.trim(n.textContent),t,this.settings.dropdown.caseSensitive)&&e.push(i)})),e},getTagElmByValue(t){var e=this.getTagIndexByValue(t)[0];return this.getTagElms()[e]},flashTag(t){t&&(t.classList.add(this.settings.classNames.tagFlash),setTimeout((()=>{t.classList.remove(this.settings.classNames.tagFlash)}),100))},isTagBlacklisted(t){return t=this.trim(t.toLowerCase()),this.settings.blacklist.filter((e=>(""+e).toLowerCase()==t)).length},isTagWhitelisted(t){return!!this.getWhitelistItem(t)},getWhitelistItem(t,e,n){e=e||"value";var i,r=this.settings;return(n=n||r.whitelist).some((n=>{var s="string"==typeof n?n:n[e]||n.value;if(a(s,t,r.dropdown.caseSensitive,r.trim))return i="string"==typeof n?{value:n}:n,!0})),i||"value"!=e||"value"==r.tagTextProp||(i=this.getWhitelistItem(t,r.tagTextProp,n)),i},validateTag(t){var e=this.settings,n="value"in t?"value":e.tagTextProp,a=this.trim(t[n]+"");return(t[n]+"").trim()?e.pattern&&e.pattern instanceof RegExp&&!e.pattern.test(a)?this.TEXTS.pattern:!e.duplicates&&this.isTagDuplicate(a,e.dropdown.caseSensitive,t.__tagId)?this.TEXTS.duplicate:this.isTagBlacklisted(a)||e.enforceWhitelist&&!this.isTagWhitelisted(a)?this.TEXTS.notAllowed:!e.validate||e.validate(t):this.TEXTS.empty},getInvalidTagAttrs(t,e){return{"aria-invalid":!0,class:`${t.class||""} ${this.settings.classNames.tagNotAllowed}`.trim(),title:e}},hasMaxTags(){return this.value.length>=this.settings.maxTags&&this.TEXTS.exceed},setReadonly(t,e){var n=this.settings;document.activeElement.blur(),n[e||"readonly"]=t,this.DOM.scope[(t?"set":"remove")+"Attribute"](e||"readonly",!0),this.setContentEditable(!t)},setContentEditable(t){this.settings.userInput&&(this.DOM.input.contentEditable=t,this.DOM.input.tabIndex=t?0:-1)},setDisabled(t){this.setReadonly(t,"disabled")},normalizeTags(t){var e=this.settings,n=e.whitelist,a=e.delimiters,i=e.mode,r=e.tagTextProp,s=[],o=!!n&&n[0]instanceof Object,l=Array.isArray(t),c=l&&t[0].value,d=t=>(t+"").split(a).filter((t=>t)).map((t=>({[r]:this.trim(t),value:this.trim(t)})));if("number"==typeof t&&(t=t.toString()),"string"==typeof t){if(!t.trim())return[];t=d(t)}else l&&(t=[].concat(...t.map((t=>null!=t.value?t:d(t)))));return o&&!c&&(t.forEach((t=>{var e=s.map((t=>t.value)),n=this.dropdown.filterListItems.call(this,t[r],{exact:!0});this.settings.duplicates||(n=n.filter((t=>!e.includes(t.value))));var a=n.length>1?this.getWhitelistItem(t[r],r,n):n[0];a&&a instanceof Object?s.push(a):"mix"!=i&&(null==t.value&&(t.value=t[r]),s.push(t))})),s.length&&(t=s)),t},parseMixTags(t){var e=this.settings,n=e.mixTagsInterpolator,a=e.duplicates,i=e.transformTag,r=e.enforceWhitelist,s=e.maxTags,o=e.tagTextProp,l=[];return t=t.split(n[0]).map(((t,e)=>{var c,d,u,h=t.split(n[1]),p=h[0],m=l.length==s;try{if(p==+p)throw Error;d=JSON.parse(p)}catch(t){d=this.normalizeTags(p)[0]||{value:p}}if(i.call(this,d),m||!(h.length>1)||r&&!this.isTagWhitelisted(d.value)||!a&&this.isTagDuplicate(d.value)){if(t)return e?n[0]+t:t}else d[c=d[o]?o:"value"]=this.trim(d[c]),u=this.createTagElem(d),l.push(d),u.classList.add(this.settings.classNames.tagNoAnimation),h[0]=u.outerHTML,this.value.push(d);return h.join("")})).join(""),this.DOM.input.innerHTML=t,this.DOM.input.appendChild(document.createTextNode("")),this.DOM.input.normalize(),this.getTagElms().forEach(((t,e)=>y(t,l[e]))),this.update({withoutChangeEvent:!0}),t},replaceTextWithNode(t,e){if(this.state.tag||e){e=e||this.state.tag.prefix+this.state.tag.value;var n,a,i=this.state.selection||window.getSelection(),r=i.anchorNode,s=this.state.tag.delimiters?this.state.tag.delimiters.length:0;return r.splitText(i.anchorOffset-s),-1==(n=r.nodeValue.lastIndexOf(e))||(a=r.splitText(n),t&&r.parentNode.replaceChild(t,a)),!0}},selectTag(t,e){var n=this.settings;if(!n.enforceWhitelist||this.isTagWhitelisted(e.value)){this.input.set.call(this,e[n.tagTextProp]||e.value,!0),this.state.actions.selectOption&&setTimeout((()=>this.setRangeAtStartEnd(!1,this.DOM.input)));var a=this.getLastTag();return a?this.replaceTag(a,e):this.appendTag(t),this.value[0]=e,this.update(),this.trigger("add",{tag:t,data:e}),[t]}},addEmptyTag(t){var e=u({value:""},t||{}),n=this.createTagElem(e);y(n,e),this.appendTag(n),this.editTag(n,{skipValidation:!0})},addTags(t,e,n){var a=[],i=this.settings,r=[],s=document.createDocumentFragment();if(n=n||i.skipInvalid,!t||0==t.length)return a;switch(t=this.normalizeTags(t),i.mode){case"mix":return this.addMixTags(t);case"select":e=!1,this.removeAllTags()}return this.DOM.input.removeAttribute("style"),t.forEach((t=>{var e,o={},l=Object.assign({},t,{value:t.value+""});if(t=Object.assign({},l),i.transformTag.call(this,t),t.__isValid=this.hasMaxTags()||this.validateTag(t),!0!==t.__isValid){if(n)return;if(u(o,this.getInvalidTagAttrs(t,t.__isValid),{__preInvalidData:l}),t.__isValid==this.TEXTS.duplicate&&this.flashTag(this.getTagElmByValue(t.value)),!i.createInvalidTags)return void r.push(t.value)}if("readonly"in t&&(t.readonly?o["aria-readonly"]=!0:delete t.readonly),e=this.createTagElem(t,o),a.push(e),"select"==i.mode)return this.selectTag(e,t);s.appendChild(e),t.__isValid&&!0===t.__isValid?(this.value.push(t),this.trigger("add",{tag:e,index:this.value.length-1,data:t})):(this.trigger("invalid",{data:t,index:this.value.length,tag:e,message:t.__isValid}),i.keepInvalidTags||setTimeout((()=>this.removeTags(e,!0)),1e3)),this.dropdown.position()})),this.appendTag(s),this.update(),t.length&&e&&(this.input.set.call(this,i.createInvalidTags?"":r.join(i._delimiters)),this.setRangeAtStartEnd(!1,this.DOM.input)),i.dropdown.enabled&&this.dropdown.refilter(),a},addMixTags(t){if((t=this.normalizeTags(t))[0].prefix||this.state.tag)return this.prefixedTextToTag(t[0]);var e=document.createDocumentFragment();return t.forEach((t=>{var n=this.createTagElem(t);e.appendChild(n)})),this.appendMixTags(e),e},appendMixTags(t){var e=!!this.state.selection;e?this.injectAtCaret(t):(this.DOM.input.focus(),(e=this.setStateSelection()).range.setStart(this.DOM.input,e.range.endOffset),e.range.setEnd(this.DOM.input,e.range.endOffset),this.DOM.input.appendChild(t),this.updateValueByDOMTags(),this.update())},prefixedTextToTag(t){var e,n=this.settings,a=this.state.tag.delimiters;if(n.transformTag.call(this,t),t.prefix=t.prefix||this.state.tag?this.state.tag.prefix:(n.pattern.source||n.pattern)[0],e=this.createTagElem(t),this.replaceTextWithNode(e)||this.DOM.input.appendChild(e),setTimeout((()=>e.classList.add(this.settings.classNames.tagNoAnimation)),300),this.value.push(t),this.update(),!a){var i=this.insertAfterTag(e)||e;setTimeout(this.placeCaretAfterNode,0,i)}return this.state.tag=null,this.trigger("add",u({},{tag:e},{data:t})),e},appendTag(t){var e=this.DOM,n=e.input;e.scope.insertBefore(t,n)},createTagElem(t,n){t.__tagId=g();var a,i=u({},t,e({value:c(t.value+"")},n));return function(t){for(var e,n=document.createNodeIterator(t,NodeFilter.SHOW_TEXT,null,!1);e=n.nextNode();)e.textContent.trim()||e.parentNode.removeChild(e)}(a=this.parseTemplate("tag",[i,this])),y(a,t),a},reCheckInvalidTags(){var t=this.settings;this.getTagElms(t.classNames.tagNotAllowed).forEach(((e,n)=>{var a=y(e),i=this.hasMaxTags(),r=this.validateTag(a),s=!0===r&&!i;if("select"==t.mode&&this.toggleScopeValidation(r),s)return a=a.__preInvalidData?a.__preInvalidData:{value:a.value},this.replaceTag(e,a);e.title=i||r}))},removeTags(t,e,n){var a,i=this.settings;if(t=t&&t instanceof HTMLElement?[t]:t instanceof Array?t:t?[t]:[this.getLastTag()],a=t.reduce(((t,e)=>{e&&"string"==typeof e&&(e=this.getTagElmByValue(e));var n=y(e);return e&&n&&!n.readonly&&t.push({node:e,idx:this.getTagIdx(n),data:y(e,{__removed:!0})}),t}),[]),n="number"==typeof n?n:this.CSSVars.tagHideTransition,"select"==i.mode&&(n=0,this.input.set.call(this)),1==a.length&&"select"!=i.mode&&a[0].node.classList.contains(i.classNames.tagNotAllowed)&&(e=!0),a.length)return i.hooks.beforeRemoveTag(a,{tagify:this}).then((()=>{function t(t){t.node.parentNode&&(t.node.parentNode.removeChild(t.node),e?i.keepInvalidTags&&this.trigger("remove",{tag:t.node,index:t.idx}):(this.trigger("remove",{tag:t.node,index:t.idx,data:t.data}),this.dropdown.refilter(),this.dropdown.position(),this.DOM.input.normalize(),i.keepInvalidTags&&this.reCheckInvalidTags()))}n&&n>10&&1==a.length?function(e){e.node.style.width=parseFloat(window.getComputedStyle(e.node).width)+"px",document.body.clientTop,e.node.classList.add(i.classNames.tagHide),setTimeout(t.bind(this),n,e)}.call(this,a[0]):a.forEach(t.bind(this)),e||(this.removeTagsFromValue(a.map((t=>t.node))),this.update(),"select"==i.mode&&this.setContentEditable(!0))})).catch((t=>{}))},removeTagsFromDOM(){[].slice.call(this.getTagElms()).forEach((t=>t.parentNode.removeChild(t)))},removeTagsFromValue(t){(t=Array.isArray(t)?t:[t]).forEach((t=>{var e=y(t),n=this.getTagIdx(e);n>-1&&this.value.splice(n,1)}))},removeAllTags(t){t=t||{},this.value=[],"mix"==this.settings.mode?this.DOM.input.innerHTML="":this.removeTagsFromDOM(),this.dropdown.refilter(),this.dropdown.position(),this.state.dropdown.visible&&setTimeout((()=>{this.DOM.input.focus()})),"select"==this.settings.mode&&(this.input.set.call(this),this.setContentEditable(!0)),this.update(t)},postUpdate(){this.state.blockChangeEvent=!1;var t=this.settings,e=t.classNames,n="mix"==t.mode?t.mixMode.integrated?this.DOM.input.textContent:this.DOM.originalInput.value.trim():this.value.length+this.input.raw.call(this).length;this.toggleClass(e.hasMaxTags,this.value.length>=t.maxTags),this.toggleClass(e.hasNoTags,!this.value.length),this.toggleClass(e.empty,!n),"select"==t.mode&&this.toggleScopeValidation(this.value?.[0]?.__isValid)},setOriginalInputValue(t){var e=this.DOM.originalInput;this.settings.mixMode.integrated||(e.value=t,e.tagifyValue=e.value,this.setPersistedData(t,"value"))},update(t){clearTimeout(this.debouncedUpdateTimeout),this.debouncedUpdateTimeout=setTimeout(function(){var e=this.getInputValue();this.setOriginalInputValue(e),this.settings.onChangeAfterBlur&&(t||{}).withoutChangeEvent||this.state.blockChangeEvent||this.triggerChangeEvent(),this.postUpdate()}.bind(this),100)},getInputValue(){var t=this.getCleanValue();return"mix"==this.settings.mode?this.getMixedTagsAsString(t):t.length?this.settings.originalInputValueFormat?this.settings.originalInputValueFormat(t):JSON.stringify(t):""},getCleanValue(t){return i(t||this.value,this.dataProps)},getMixedTagsAsString(){var t="",e=this,n=this.settings,a=n.originalInputValueFormat||JSON.stringify,i=n.mixTagsInterpolator;return function n(s){s.childNodes.forEach((s=>{if(1==s.nodeType){const o=y(s);if("BR"==s.tagName&&(t+="\r\n"),o&&f.call(e,s)){if(o.__removed)return;t+=i[0]+a(r(o,e.dataProps))+i[1]}else s.getAttribute("style")||["B","I","U"].includes(s.tagName)?t+=s.textContent:"DIV"!=s.tagName&&"P"!=s.tagName||(t+="\r\n",n(s))}else t+=s.textContent}))}(this.DOM.input),t}},C.prototype.removeTag=C.prototype.removeTags,C}()},184:function(t,e){var n;!function(){"use strict";var a={}.hasOwnProperty;function i(){for(var t=[],e=0;e<arguments.length;e++){var n=arguments[e];if(n){var r=typeof n;if("string"===r||"number"===r)t.push(n);else if(Array.isArray(n)){if(n.length){var s=i.apply(null,n);s&&t.push(s)}}else if("object"===r){if(n.toString!==Object.prototype.toString&&!n.toString.toString().includes("[native code]")){t.push(n.toString());continue}for(var o in n)a.call(n,o)&&n[o]&&t.push(o)}}}return t.join(" ")}t.exports?(i.default=i,t.exports=i):void 0===(n=function(){return i}.apply(e,[]))||(t.exports=n)}()}},e={};function n(a){var i=e[a];if(void 0!==i)return i.exports;var r=e[a]={exports:{}};return t[a].call(r.exports,r,r.exports,n),r.exports}n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,{a:e}),e},n.d=function(t,e){for(var a in e)n.o(e,a)&&!n.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},function(){"use strict";var t=jQuery,e=n.n(t),a=n(184),i=n.n(a),r=lodash,s=wp.i18n,o=wp.hooks,l=wp.components,c=wp.element,d=wp.plugins,u=wp.data,h=wp.editPost,p=wp.compose;function m(t){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m(t)}var g=["tabId","onClick","children","selected"];function f(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,T(a.key),a)}}function v(t,e){return v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},v(t,e)}function y(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,a=b(t);if(e){var i=b(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return function(t,e){if(e&&("object"===m(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return w(t)}(this,n)}}function w(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function b(t){return b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},b(t)}function k(t,e,n){return(e=T(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function T(t){var e=function(t,e){if("object"!==m(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var a=n.call(t,e||"default");if("object"!==m(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===m(e)?e:String(e)}function _(){return _=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},_.apply(this,arguments)}function E(t,e){if(null==t)return{};var n,a,i=function(t,e){if(null==t)return{};var n,a,i={},r=Object.keys(t);for(a=0;a<r.length;a++)n=r[a],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(a=0;a<r.length;a++)n=r[a],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}var O=function(t){var e=t.tabId,n=t.onClick,a=t.children,i=t.selected,r=E(t,g);return wp.element.createElement(l.Button,_({role:"tab",tabIndex:i?null:-1,"aria-selected":i,id:e,onClick:n},r),a)},S=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&v(t,e)}(o,t);var e,n,a,s=y(o);function o(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),k(w(t=s.apply(this,arguments)),"handleClick",(function(e){var n=t.props.onSelect,a=void 0===n?r.noop:n;t.setState({selected:e}),a(e)})),k(w(t),"onNavigate",(function(t,e){e.click()}));var e=t.props,n=e.tabs,a=e.initialTabName;return t.state={selected:a||(n.length>0?n[0].name:null)},t}return e=o,(n=[{key:"render",value:function(){var t=this,e=this.state.selected,n=this.props,a=n.activeClass,s=void 0===a?"is-active":a,o=n.className,c=n.instanceId,d=n.orientation,u=void 0===d?"horizontal":d,h=n.tabs,p=(0,r.find)(h,{name:e}),m=c+"-"+p.name,g=h.slice(4);return wp.element.createElement("div",{className:o},wp.element.createElement(l.NavigableMenu,{role:"tablist",orientation:u,onNavigate:this.onNavigate,className:"components-tab-panel__tabs "+e},h.slice(0,4).map((function(n){return wp.element.createElement(O,{className:i()("components-tab-panel__tabs-item",n.className,k({},s,n.name===e)),tabId:c+"-"+n.name,"aria-controls":c+"-"+n.name+"-view",selected:n.name===e,key:n.name,onClick:(0,r.partial)(t.handleClick,n.name)},n.title)})),g.map((function(n){return wp.element.createElement(O,{className:i()("components-tab-panel__tabs-item",n.className,k({},s,n.name===e)),tabId:c+"-"+n.name,"aria-controls":c+"-"+n.name+"-view",selected:n.name===e,key:n.name,onClick:(0,r.partial)(t.handleClick,n.name)},n.title)}))),p&&wp.element.createElement("div",{"aria-labelledby":m,role:"tabpanel",id:m+"-view",className:"components-tab-panel__tab-content"},this.props.children(p)))}}])&&f(e.prototype,n),a&&f(e,a),Object.defineProperty(e,"prototype",{writable:!1}),o}(c.Component),C=(0,p.withInstanceId)(S),x=wp.apiFetch,N=n.n(x);function D(t){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},D(t)}function M(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,(i=a.key,r=void 0,r=function(t,e){if("object"!==D(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var a=n.call(t,e||"default");if("object"!==D(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===D(r)?r:String(r)),a)}var i,r}function I(t,e){return I=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},I(t,e)}function A(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,a=j(t);if(e){var i=j(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return function(t,e){if(e&&("object"===D(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return P(t)}(this,n)}}function P(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function j(t){return j=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},j(t)}var L=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&I(t,e)}(o,t);var e,n,a,i=A(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.apply(this,arguments)).state={score:0},t.setState=t.setState.bind(P(t)),t}return e=o,(n=[{key:"render",value:function(){var t=this;return setTimeout((function(){t.setState({score:t.props.score})}),1e3),wp.element.createElement("div",{className:"rank-math-ca-score"},wp.element.createElement("div",{className:"score-text"},(0,s.__)("Score:","rank-math")," ",this.state.score,wp.element.createElement("span",null," / ",(0,s.__)("100","rank-math"))),wp.element.createElement("div",{className:"score-wrapper"},wp.element.createElement("span",{className:"score-dot",style:{left:((0,r.inRange)(this.state.score,0,5)?5:this.state.score)+"%"}})))}}])&&M(e.prototype,n),a&&M(e,a),Object.defineProperty(e,"prototype",{writable:!1}),o}(c.Component),R=(0,p.compose)((0,u.withSelect)((function(t){var e=Object.values(t("rank-math").getContentAIScore());return{score:(0,r.round)((0,r.sum)(e)/e.length)}})))(L);function V(t){return 100<t?"bad-fk dark":80<t?"good-fk":50<t?"ok-fk":"bad-fk"}function B(t){return B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},B(t)}function F(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,(i=a.key,r=void 0,r=function(t,e){if("object"!==B(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var a=n.call(t,e||"default");if("object"!==B(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===B(r)?r:String(r)),a)}var i,r}function H(t,e){return H=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},H(t,e)}function $(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,a=U(t);if(e){var i=U(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return function(t,e){if(e&&("object"===B(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return K(t)}(this,n)}}function K(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function U(t){return U=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},U(t)}var q=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&H(t,e)}(l,t);var e,n,a,o=$(l);function l(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),(t=o.apply(this,arguments)).state={activeTab:""},t.setState=t.setState.bind(K(t)),t}return e=l,n=[{key:"render",value:function(){return wp.element.createElement("div",{className:"rank-math-ca-recommendations"},this.getRecommendations(this.props.recommendations))}},{key:"getRecommendations",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=[];return(0,r.forEach)(t,(function(t,o){if("total"!==o){var l=(0,r.isUndefined)(t.total)?t:t.total,c=e.getPostStats(o),d=i()(o,{"has-children":!(0,r.isUndefined)(t.total),show:o===e.state.activeTab}),u=e.getScore(o,c,l,n),h=(0,r.ceil)(150*l/100);a.push(wp.element.createElement("div",{key:o,className:d+" "+V(u),onClick:function(){return e.setState({activeTab:e.state.activeTab!==o?o:""})},role:"presentation"},wp.element.createElement("h4",null,n?o:(0,r.startCase)(o)),n&&wp.element.createElement("span",null,c," / ",l),!n&&wp.element.createElement(React.Fragment,null,wp.element.createElement("strong",null,c),wp.element.createElement("span",{className:"desc"},(0,s.__)("Use","rank-math")," ",l," ",(0,s.__)("to","rank-math")," ",h)),(0,r.isObject)(t)&&e.getRecommendations(t,!0)))}})),n?wp.element.createElement("div",{className:"submenu"},a):a}},{key:"getPostStats",value:function(t){return(0,r.has)(this.props.postStats,t)?this.props.postStats[t]:0}},{key:"getScore",value:function(t,e,n,a){var i=e===n?100:e/n*100;if(0===n&&e<=2&&(i=100),a)return i>100&&i<=125?100:i;var r=i>80?100:e/n*80;return i>125&&"wordCount"!==t&&(r=0),this.props.updateAiScore(t,r),i>100&&"wordCount"===t||i>100&&i<=125?100:i}}],n&&F(e.prototype,n),a&&F(e,a),Object.defineProperty(e,"prototype",{writable:!1}),l}(c.Component),W=(0,p.compose)((0,u.withSelect)((function(t,e){var n=1518,a=12,i=2,s=5,o=3,l=0,c=0,d=0,u=8,h=19;if(e.hasCredits){var p=e.researcher.getResearch("wordCount"),m=rankMathEditor.assessor.analyzer.defaultAnalyses.contentHasAssets;n=p(e.content),a=(0,r.isUndefined)(m)||(0,r.isUndefined)(e.researcher.paper)?0:m.getImages(e.researcher.paper,e.content),i=(0,r.isUndefined)(m)?0:m.getVideos(e.content),s=(e.content.match(/<h2\b[^>]*>(.*?)<\/h2>/g)||[]).length,o=(e.content.match(/<h3\b[^>]*>(.*?)<\/h3>/g)||[]).length,l=(e.content.match(/<h4\b[^>]*>(.*?)<\/h4>/g)||[]).length,c=(e.content.match(/<h5\b[^>]*>(.*?)<\/h5>/g)||[]).length,d=(e.content.match(/<h6\b[^>]*>(.*?)<\/h6>/g)||[]).length;var g=e.researcher.getResearch("getLinkStats")(e.content);u=g.internalTotal,h=g.externalTotal}return{postStats:{wordCount:n,images:a,videos:i,mediaCount:a+i,h2:s,h3:o,h4:l,h5:c,h6:d,headingCount:s+o+l+c+d,internal:u,external:h,linkCount:u+h}}})))(q),z=rankMathAnalyzer;function J(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=rankMath.links[t]||"";if(!n)return"#";if(!e)return n;var a={utm_source:"Plugin",utm_medium:encodeURIComponent(e),utm_campaign:"WP"};return n+"?"+Object.keys(a).map((function(t){return"".concat(t,"=").concat(a[t])})).join("&")}function X(t){return X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},X(t)}function Q(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,(i=a.key,r=void 0,r=function(t,e){if("object"!==X(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var a=n.call(t,e||"default");if("object"!==X(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===X(r)?r:String(r)),a)}var i,r}function G(t,e){return G=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},G(t,e)}function Y(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,a=tt(t);if(e){var i=tt(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return function(t,e){if(e&&("object"===X(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Z(t)}(this,n)}}function Z(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function tt(t){return tt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},tt(t)}var et=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&G(t,e)}(d,t);var e,n,a,o=Y(d);function d(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d),(t=o.apply(this,arguments)).state={type:"content",selected:""},t.setState=t.setState.bind(Z(t)),t.initializeClipboard(t.setState),t}return e=d,n=[{key:"initializeClipboard",value:function(t){"function"==typeof ClipboardJS&&this.props.hasCredits&&new ClipboardJS(".rank-math-tooltip strong",{text:function(t){return t.getAttribute("data-key")}}).on("success",(function(){setTimeout((function(){t({selected:""})}),3e3)}))}},{key:"render",value:function(){var t=this;return wp.element.createElement(c.Fragment,null,wp.element.createElement(l.PanelBody,{initialOpen:!0},wp.element.createElement(l.SelectControl,{label:(0,s.__)("Use Keyword in","rank-math"),value:this.state.type,options:[{value:"content",label:(0,s.__)("Content","rank-math")},{value:"heading",label:(0,s.__)("Headings","rank-math")},{value:"title",label:(0,s.__)("SEO Title","rank-math")},{value:"description",label:(0,s.__)("SEO Description","rank-math")}],onChange:function(e){t.setState({type:e})}}),wp.element.createElement("a",{href:J("content-ai-keywords","Sidebar Keywords KB Icon"),rel:"noreferrer",target:"_blank",id:"rank-math-help-icon",title:(0,s.__)("Know more about Keywords.","rank-math")},"ï¹"),wp.element.createElement(React.Fragment,null,wp.element.createElement("span",{className:"components-form-token-field__help"},(0,s.__)("Click on any keyword to copy it.","rank-math")),wp.element.createElement("br",null),(0,r.includes)(["title","description"],this.state.type)&&wp.element.createElement("span",{className:"components-form-token-field__help"},(0,s.__)("Please use only one or two keywords from here.","rank-math")),wp.element.createElement("ul",null,this.getKeywords())),this.getRelatedKeywords()))}},{key:"getRelatedKeywords",value:function(){var t=this;if("content"!==this.state.type||(0,r.isEmpty)(this.props.caData.data.related_keywords))return!1;var e=[];return(0,r.forEach)(this.props.caData.data.related_keywords,(function(n,a){e.push(wp.element.createElement("li",{key:a,className:"rank-math-tooltip show",onClick:function(){return t.setState({selected:n})},role:"presentation"},wp.element.createElement("strong",{"data-key":n},n),t.getTooltipContent({keyword:n},!0)))})),wp.element.createElement("div",{className:"rank-math-related-keywords"},wp.element.createElement("h3",null,(0,s.__)("Related Keywords","rank-math")),wp.element.createElement("ul",null,e))}},{key:"getKeywords",value:function(){var t=this;if((0,r.isEmpty)(this.props.caData.data.keywords))return wp.element.createElement("h3",{className:"no-data"},(0,s.__)("There are no recommended Keywords for this researched keyword.","rank-math"));var e=[];return this.contentAiScore={},(0,r.forEach)(this.props.caData.data.keywords,(function(n,a){(0,r.isEmpty)(n)||(t.contentAiScore[a]={},(0,r.forEach)(n,(function(n,r){var s=t.props.hasCredits?t.getCount(n.keyword,a):n.count,o=V(t.getScore(n.keyword,s,n.average,a)),l=i()("rank-math-tooltip",{show:t.state.type===a});e.push(wp.element.createElement("li",{key:a+" - "+r,className:l+" "+o,onClick:function(){return t.setState({selected:n.keyword})},role:"presentation"},wp.element.createElement("strong",{"data-key":n.keyword},n.keyword,wp.element.createElement("span",null,s," / ",n.average)),t.getTooltipContent(n)))})))})),this.updateContentAiScore(),e}},{key:"updateContentAiScore",value:function(){var t=0,e=0;(0,r.forEach)(this.contentAiScore,(function(n,a){var i=Object.values(n),s=(0,r.sum)(i);"title"!==a&&"description"!==a||100!==(0,r.max)(i)||(s=100*i.length),t+=s,e+=i.length})),t/=e,(0,r.isNaN)(t)||this.props.updateAiScore("keywords",t)}},{key:"getScore",value:function(t,e,n,a){var i=e/n*100;return this.contentAiScore[a][t]=i>100?0:i>80?100:i,i}},{key:"getTooltipContent",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.props.hasCredits)return this.state.selected===t.keyword?wp.element.createElement("span",{className:"rank-math-tooltip-data"},(0,s.__)("Copied","rank-math")):t.competition||t.cpc||t.search_volume?wp.element.createElement("span",{className:"rank-math-tooltip-data"},wp.element.createElement("span",null,(0,s.__)("Ad Competition:","rank-math")," ",(0,r.round)(100*t.competition)),wp.element.createElement("span",null,(0,s.__)("CPC:","rank-math")," $",(0,r.round)(t.cpc,2)),wp.element.createElement("span",null,(0,s.__)("Volume:","rank-math")," ",(0,r.round)(t.search_volume))):wp.element.createElement("span",{className:"rank-math-tooltip-data"},e?(0,s.__)("Click to copy keyword","rank-math"):(0,s.__)("No data available","rank-math"))}},{key:"getCount",value:function(t,e){var n=this.props.caData.content;if(t=z.Helpers.removeDiacritics(t).toLowerCase(),"heading"===e){t=t.replace(/[\\^$*+?.()|[\]{}]/g,"\\$&");var a=new RegExp("<h[2-6][^>]*>.*?"+t+".*?</h[2-6]>","g"),i=n.match(a);return(0,r.isNull)(i)?0:i.length}return"title"===e&&(n=this.props.caData.title),"description"===e&&(n=this.props.caData.description),z.Helpers.cleanTagsOnly(n).split(t).length-1}}],n&&Q(e.prototype,n),a&&Q(e,a),Object.defineProperty(e,"prototype",{writable:!1}),d}(c.Component),nt=(0,p.compose)((0,u.withDispatch)((function(t){return{toggleEditor:function(){t("rank-math").toggleSnippetEditor(!0)}}})))(et),at=function(){return!((0,r.isNil)(window.wp)||(0,r.isNil)(wp.data)||(0,r.isNil)(wp.data.select("core/editor"))||!window.document.body.classList.contains("block-editor-page")||!(0,r.isFunction)(wp.data.select("core/editor").getEditedPostAttribute))};function it(t){return it="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},it(t)}function rt(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,(i=a.key,r=void 0,r=function(t,e){if("object"!==it(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var a=n.call(t,e||"default");if("object"!==it(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===it(r)?r:String(r)),a)}var i,r}function st(t,e){return st=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},st(t,e)}function ot(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,a=ct(t);if(e){var i=ct(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return function(t,e){if(e&&("object"===it(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return lt(t)}(this,n)}}function lt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ct(t){return ct=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ct(t)}var dt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&st(t,e)}(o,t);var e,n,a,i=ot(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.apply(this,arguments)).state={iconClass:"rm-icon-copy",selected:""},t.setState=t.setState.bind(lt(t)),t.initializeClipboard(t.setState),t}return e=o,(n=[{key:"initializeClipboard",value:function(t){var e=this;"function"==typeof ClipboardJS&&new ClipboardJS(".rank-math-copy-questions, .rank-math-questions-item h3",{text:function(t){if(!(0,r.isNull)(t.getAttribute("data-key")))return t.getAttribute("data-key");if(!at())return document.getElementById("rank-math-ca-questions-data").innerHTML;var n=[];return(0,r.forEach)(e.props.caData.data.related_questions,(function(t){n.push({id:(0,r.uniqueId)("faq-question-"),title:t,content:"",visible:!0})})),"\x3c!-- wp:rank-math/faq-block "+JSON.stringify({questions:n})+' --\x3e<div class="wp-block-rank-math-faq-block"></div>\x3c!-- /wp:rank-math/faq-block --\x3e'}}).on("success",(function(){setTimeout((function(){t({iconClass:"rm-icon-copy"})}),3e3)}))}},{key:"render",value:function(){var t=this,e=[];return(0,r.isEmpty)(this.props.caData.data.related_questions)?wp.element.createElement("h3",{className:"no-data"},(0,s.__)("There are no recommended Questions for this researched keyword.","rank-math")):((0,r.forEach)(this.props.caData.data.related_questions,(function(n,a){e.push(wp.element.createElement("div",{className:"rank-math-questions-item",key:a},wp.element.createElement("h3",{className:"rank-math-tooltip","data-key":n,onClick:function(){return t.setState({selected:n})},role:"presentation"},n,t.getTooltipContent(n))))})),wp.element.createElement(c.Fragment,null,wp.element.createElement(l.PanelBody,{initialOpen:!0},wp.element.createElement("div",{className:"rank-math-section-heading"},wp.element.createElement("h2",null,(0,s.__)("Related Questions","rank-math"),wp.element.createElement("a",{href:J("content-ai-settings","Sidebar Questions KB Icon"),rel:"noreferrer",target:"_blank",id:"rank-math-help-icon",title:(0,s.__)("Know more about Questions.","rank-math")},"ï¹")),wp.element.createElement(l.Button,{onClick:function(){t.setState({iconClass:"rm-icon-tick"})},className:"rank-math-copy-questions button-secondary rank-math-tooltip left"},wp.element.createElement("i",{className:"rm-icon "+this.state.iconClass}),wp.element.createElement("span",null,(0,s.__)("Copy this data as a FAQ Block.","rank-math")))),wp.element.createElement("span",{className:"components-form-token-field__help"},(0,s.__)("Click on any question to copy it.","rank-math")),wp.element.createElement("div",{id:"rank-math-ca-questions-data"},e))))}},{key:"getTooltipContent",value:function(t){return this.state.selected===t&&wp.element.createElement("span",{className:"rank-math-tooltip-data"},(0,s.__)("Copied","rank-math"))}}])&&rt(e.prototype,n),a&&rt(e,a),Object.defineProperty(e,"prototype",{writable:!1}),o}(c.Component),ut=dt,ht=function(t){var e=[];return(0,r.isEmpty)(t.caData.data.links)?wp.element.createElement("h3",{className:"no-data"},(0,s.__)("There are no recommended Links for this researched keyword.","rank-math")):((0,r.forEach)(t.caData.data.links,(function(t,n){return e.push(wp.element.createElement("li",{key:n},wp.element.createElement("a",{href:t,rel:"noreferrer",target:"_blank"},t)))})),wp.element.createElement(c.Fragment,null,wp.element.createElement(l.PanelBody,{initialOpen:!0},wp.element.createElement("div",{className:"rank-math-section-heading"},wp.element.createElement("h2",null,(0,s.__)("Related External Links","rank-math"),wp.element.createElement("a",{href:J("content-ai-links","Sidebar Links KB Icon"),rel:"noreferrer",target:"_blank",id:"rank-math-help-icon",title:(0,s.__)("Know more about Links.","rank-math")},"ï¹")),wp.element.createElement("p",null,(0,s.__)("Use some of these external links in the content area. It is recommended to add","rank-math")," ",wp.element.createElement("a",{href:J("about-and-mentions-schema","Use Some External Links"),rel:"noreferrer",target:"_blank"},(0,s.__)("about or mention Schema.","rank-math")))),wp.element.createElement("ul",null,e))))},pt=function(t){"social"===t&&(0,u.dispatch)("rank-math").toggleSnippetEditor(!0)},mt=function(t){return wp.element.createElement(C,{className:"rank-math-contentai-tabs",activeClass:"is-active",tabs:[{name:"keywords",title:wp.element.createElement(c.Fragment,null,wp.element.createElement("span",null,(0,s.__)("Keywords","rank-math"))),view:nt,className:"rank-math-keywords-tab"},{name:"questions",title:wp.element.createElement(c.Fragment,null,wp.element.createElement("span",null,(0,s.__)("Questions","rank-math"))),view:ut,className:"rank-math-questions-tab"},{name:"links",title:wp.element.createElement(c.Fragment,null,wp.element.createElement("span",null,(0,s.__)("Links","rank-math"))),view:ht,className:"rank-math-recommended-links-tab"}],onSelect:pt,data:t},(function(e,n){return wp.element.createElement("div",{className:"rank-math-contentai-tab-content-"+e.name,key:n},(0,c.createElement)(e.view,t))}))},gt=React;function ft(t){return t.startsWith("{{/")?{type:"componentClose",value:t.replace(/\W/g,"")}:t.endsWith("/}}")?{type:"componentSelfClosing",value:t.replace(/\W/g,"")}:t.startsWith("{{")?{type:"componentOpen",value:t.replace(/\W/g,"")}:{type:"string",value:t}}function vt(t,e){let n,a,i=[];for(let r=0;r<t.length;r++){const s=t[r];if("string"!==s.type){if(void 0===e[s.value])throw new Error(`Invalid interpolation, missing component node: \`${s.value}\``);if("object"!=typeof e[s.value])throw new Error(`Invalid interpolation, component node must be a ReactElement or null: \`${s.value}\``);if("componentClose"===s.type)throw new Error(`Missing opening component token: \`${s.value}\``);if("componentOpen"===s.type){n=e[s.value],a=r;break}i.push(e[s.value])}else i.push(s.value)}if(n){const r=function(t,e){const n=e[t];let a=0;for(let i=t+1;i<e.length;i++){const t=e[i];if(t.value===n.value){if("componentOpen"===t.type){a++;continue}if("componentClose"===t.type){if(0===a)return i;a--}}}throw new Error("Missing closing component token `"+n.value+"`")}(a,t),s=vt(t.slice(a+1,r),e),o=(0,gt.cloneElement)(n,{},s);if(i.push(o),r<t.length-1){const n=vt(t.slice(r+1),e);i=i.concat(n)}}return i=i.filter(Boolean),0===i.length?null:1===i.length?i[0]:(0,gt.createElement)(gt.Fragment,null,...i)}function yt(t){const{mixedString:e,components:n,throwErrors:a}=t;if(!n)return e;if("object"!=typeof n){if(a)throw new Error(`Interpolation Error: unable to process \`${e}\` because components is not an object`);return e}const i=function(t){return t.split(/(\{\{\/?\s*\w+\s*\/?\}\})/g).map(ft)}(e);try{return vt(i,n)}catch(t){if(a)throw new Error(`Interpolation Error: unable to process \`${e}\` because of error \`${t.message}\``);return e}}var wt=function(t){var e=t.tags,n=t.components,a=t.children;return n=n||{},!1===(0,r.isUndefined)(e)&&(e=e.split(",")).forEach((function(t){var e=t;n[t]=wp.element.createElement(e,null)})),yt({mixedString:a,components:n})};function bt(t){return bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bt(t)}function kt(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,(i=a.key,r=void 0,r=function(t,e){if("object"!==bt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var a=n.call(t,e||"default");if("object"!==bt(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===bt(r)?r:String(r)),a)}var i,r}function Tt(t,e){return Tt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Tt(t,e)}function _t(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,a=Ot(t);if(e){var i=Ot(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return function(t,e){if(e&&("object"===bt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Et(t)}(this,n)}}function Et(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ot(t){return Ot=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ot(t)}var St=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Tt(t,e)}(h,t);var n,a,d,u=_t(h);function h(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),(t=u.apply(this,arguments)).state={keyword:t.props.keyword,showResearch:t.props.keyword!==rankMath.ca_keyword.keyword,country:t.props.country,credits:1,loading:!1},t.setState=t.setState.bind(Et(t)),t}return n=h,(a=[{key:"render",value:function(){var t=rankMath.isUserRegistered&&(0,r.isNumber)(this.state.credits),e=i()("rank-math-content-ai-data",{loading:this.state.loading,blurred:!t}),n=this.props.data;return(!t&&(0,r.isEmpty)(n)||"show_dummy_data"===n)&&(n=this.getDummyData()),wp.element.createElement(c.Fragment,null,wp.element.createElement(l.PanelBody,{className:"rank-math-content-ai-wrapper",initialOpen:!0},wp.element.createElement(React.Fragment,null,this.getHeader(),!rankMath.isUserRegistered&&this.connectAccountNotice(),rankMath.isUserRegistered&&!t&&this.creditsNotice(t),t&&this.keywordField(),wp.element.createElement("div",{className:e},wp.element.createElement("span",{className:"loader-text"},wp.element.createElement("span",null,(0,s.__)("Fetching Search Results","rank-math")),wp.element.createElement("span",null,(0,s.__)("Analysing Your Competitors","rank-math")),wp.element.createElement("span",null,(0,s.__)("Crunching the Numbers","rank-math")),wp.element.createElement("span",null,(0,s.__)("Cooking a Personalized SEO Plan","rank-math")),wp.element.createElement("span",null,(0,s.__)("Final Touches to the SEO Recommendations","rank-math"))),(0,r.isString)(n)&&wp.element.createElement("h3",{className:"no-data"},n),!(0,r.isEmpty)(n)&&!(0,r.isString)(n)&&wp.element.createElement("div",null,wp.element.createElement("h3",{className:"rank-math-ca-section-title"},(0,s.__)("Content AI","rank-math"),wp.element.createElement("span",null,(0,s.__)("New!","rank-math")),wp.element.createElement("a",{href:J("content-ai-settings","Sidebar KB Icon"),rel:"noreferrer",target:"_blank",id:"rank-math-help-icon",title:(0,s.__)("Content AI Knowledge Base.","rank-math")},"ï¹")),wp.element.createElement(R,null),wp.element.createElement(W,{recommendations:n.recommendations,hasCredits:t,content:this.props.content,researcher:this.props.researcher,updateAiScore:this.props.updateAiScore,hasThumbnail:this.props.hasThumbnail}),wp.element.createElement(mt,{caData:this.props,updateAiScore:this.props.updateAiScore,hasCredits:t}))))))}},{key:"getDummyData",value:function(){return{keywords:{content:{"rank math":{keyword:"rank math",average:17,count:12},"rank math vs yoast seo":{keyword:"rank math vs yoast seo",average:1,count:1},"what is rank math":{keyword:"what is rank math",average:1,count:1},"rank math schema":{keyword:"rank math schema",average:1,count:1},"rank math configuration":{keyword:"rank math configuration",average:1,count:1},"rank math pro version":{keyword:"rank math pro version",average:1,count:2},"rank math comparison":{keyword:"rank math comparison",average:1,count:1},"rank math for seo":{keyword:"rank math for seo",average:1,count:1},"seo by rank math":{keyword:"seo by rank math",average:1,count:0}}},related_keywords:["rank math plugin","rank math pricing","rank math vs yoast","rank math review","rank math premium","how to use rank math","rank math training","rank math woocommerce","wordpress seo plugin"],recommendations:{wordCount:1829,linkCount:{total:16},headingCount:{total:9},mediaCount:{total:18}}}}},{key:"getHeader",value:function(){var t=this;return wp.element.createElement("div",{className:"rank-math-ca-top-section"},(0,r.includes)(["elementor","divi"],rankMath.currentEditor)&&wp.element.createElement(l.Button,{onClick:function(){return e()(".rank-math-general-tab").trigger("click")}},wp.element.createElement("i",{className:"dashicons dashicons-arrow-left-alt"}),(0,s.__)("Back","rank-math")),wp.element.createElement(l.SelectControl,{value:this.state.country,onChange:function(e){return t.setState({country:e,showResearch:!0})},options:rankMath.countries}))}},{key:"keywordField",value:function(){var t=this;return wp.element.createElement("div",{className:"rank-math-ca-keywords-wrapper"},wp.element.createElement("div",{className:"rank-math-ca-credits-wrapper"},wp.element.createElement(l.TextControl,{label:(0,s.__)("Focus Keyword","rank-math"),value:this.state.keyword,onChange:function(e){return t.setState({keyword:e,showResearch:!0})},onKeyDown:function(t){"Enter"===t.key&&t.preventDefault()},help:(0,o.applyFilters)("rank_math_content_ai_help_text",wp.element.createElement(React.Fragment,null,(0,s.__)("Upgrade to buy more credits from ","rank-math"),wp.element.createElement("a",{href:J("content-ai-pricing-tables","Sidebar Upgrade Text"),rel:"noreferrer",target:"_blank",title:(0,s.__)("Content AI Pricing.","rank-math")},(0,s.__)("here.","rank-math")))),placeholder:(0,s.__)("Suggested length 2-3 Words","rank-math")}),wp.element.createElement("div",{className:"help-text"},(0,s.__)("To learn how to use it","rank-math")," ",wp.element.createElement("a",{href:J("content-ai-settings","Content AI Sidebar KB Link"),target:"_blank",rel:"noreferrer"},(0,s.__)("Click here","rank-math"))),!this.state.showResearch&&!this.state.loading&&!(0,r.isEmpty)(this.props.data)&&wp.element.createElement(l.Button,{className:"rank-math-ca-force-update rank-math-tooltip left",onClick:function(){return t.props.researchKeyword(t.state,t.setState,!0)}},wp.element.createElement("i",{className:"dashicons dashicons-image-rotate"}),wp.element.createElement("span",null,(0,s.__)("Refresh will use one new credit.","rank-math")))),this.state.showResearch&&wp.element.createElement(l.Button,{className:"is-primary",onClick:function(){return t.props.researchKeyword(t.state,t.setState)},title:(0,s.__)("One credit will be used.","rank-math"),disabled:!this.state.keyword},(0,s.__)("Research","rank-math")))}},{key:"connectAccountNotice",value:function(){return wp.element.createElement("div",{className:"rank-math-ca-warning"},wp.element.createElement("h3",null,(0,s.__)("Content AI","rank-math")),wp.element.createElement("p",null,(0,s.__)("Please connect your account to use this feature.","rank-math")),wp.element.createElement(l.Button,{href:rankMath.connectSiteUrl,className:"is-primary"},(0,s.__)("Connect Now","rank-math")))}},{key:"creditsNotice",value:function(){return wp.element.createElement("div",{className:"rank-math-ca-warning"},wp.element.createElement("h3",null,(0,s.__)("Content AI","rank-math")),"site_limit_reached"===this.state.credits&&wp.element.createElement("p",null,wp.element.createElement(wt,{components:{link1:wp.element.createElement("a",{href:J("free-account","Sidebar No Credits"),target:"_blank",rel:"noopener noreferrer"}),link2:wp.element.createElement("a",{href:J("content-ai-pricing-tables","Sidebar No Credits"),target:"_blank",rel:"noopener noreferrer"})}},(0,o.applyFilters)("rank_math_content_ai_credits_notice",(0,s.__)("All credits assigned to this site are used. Please add more credits from {{link1}}My Account{{/link1}} Page or {{link2}}upgrade your plan{{/link2}}.","rank-math"),"site_limit_reached"))),"account_limit_reached"===this.state.credits&&(0,o.applyFilters)("rank_math_content_ai_credits_notice",wp.element.createElement(React.Fragment,null,wp.element.createElement("p",null,(0,s.__)("You don't have any credits left.","rank-math")),wp.element.createElement(l.Button,{href:J("content-ai-pricing-tables","Sidebar No Credits"),target:"_blank",rel:"noreferrer",className:"is-primary"},(0,s.__)("Get More Credits","rank-math"))),"account_limit_reached"))}}])&&kt(n.prototype,a),d&&kt(n,d),Object.defineProperty(n,"prototype",{writable:!1}),h}(c.Component),Ct=(0,p.compose)((0,u.withSelect)((function(t){var e=rankMathEditor.assessor.analyzer.researcher,n=e.paper;return{data:t("rank-math").getKeywordsData(),keyword:(0,r.get)(rankMath.ca_keyword,"keyword",t("rank-math").getKeywords().split(",")[0]),country:(0,r.get)(rankMath.ca_keyword,"country",rankMath.contentAiCountry),researcher:e,content:(0,r.isUndefined)(n)?"":n.getTextLower(),title:(0,r.isUndefined)(n)?"":n.getTitle().toLowerCase(),description:(0,r.isUndefined)(n)?"":n.getDescription().toLowerCase(),hasThumbnail:(0,r.isUndefined)(n)?"":n.hasThumbnail(),score:t("rank-math").getContentAIScore()}})),(0,u.withDispatch)((function(t,e){return{researchKeyword:function(n,a){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];n.force_update=i,n.objectID=rankMath.objectID,n.objectType=rankMath.objectType,a({showResearch:!1,loading:!0}),N()({method:"POST",path:"/rankmath/v1/ca/researchKeyword",data:n}).catch((function(t){a({loading:!1,showResearch:!0}),alert(t.message)})).then((function(n){a({loading:!1}),t("rank-math").updateKeywordsData(n.data),(0,r.isNull)(n.credits)||(0,r.isUndefined)(n.credits)||(a({credits:n.credits}),e.setCredits((0,r.isNumber)(n.credits)?n.credits:0)),(0,o.doAction)("rank_math_content_ai_changed",n.keyword)}))},updateAiScore:function(n,a){var i=e.score;i[n]=(0,r.round)(a,2),t("rank-math").updateAIScore(i)}}})))(St);function xt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var a,i,r,s,o=[],l=!0,c=!1;try{if(r=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(a=r.call(n)).done)&&(o.push(a.value),o.length!==e);l=!0);}catch(t){c=!0,i=t}finally{try{if(!l&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw i}}return o}}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return Nt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Nt(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Nt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function Dt(){var t,e=xt((0,c.useState)(""),2),n=e[0],a=e[1],r=xt((0,c.useState)(rankMath.ca_credits),2),d=r[0],u=r[1],h=i()("rank-math-tooltip update-credits",{loading:n});return wp.element.createElement(l.PanelBody,{className:"rank-math-content-ai-wrapper",initialOpen:!0},wp.element.createElement("div",{className:"rank-math-ca-credits"},wp.element.createElement(l.Button,{className:h,onClick:function(){a(!0),N()({method:"POST",path:"/rankmath/v1/ca/getCredits"}).catch((function(t){a(""),alert(t.message)})).then((function(t){u(t),a("")}))}},wp.element.createElement("i",{className:"dashicons dashicons-image-rotate"}),wp.element.createElement("span",null,(0,s.__)("Click to refresh the available credits.","rank-math"))),wp.element.createElement("span",null,(0,s.__)("Credits","rank-math"))," ",wp.element.createElement("strong",{title:d},(t=d,Math.abs(t)>999?Math.sign(t)*(Math.abs(t)/1e3).toFixed(1)+"k":Math.sign(t)*Math.abs(t))),wp.element.createElement("a",{href:J("content-ai-credits-usage","Sidebar Credits Tooltip Icon"),rel:"noreferrer",target:"_blank",id:"rank-math-help-icon",title:(0,s.__)("Know more about credits.","rank-math")},"ï¹")),wp.element.createElement(C,{className:"rank-math-tabs",activeClass:"is-active",tabs:(0,o.applyFilters)("rank_math_content_ai_tabs",[{name:"content-ai",title:wp.element.createElement(c.Fragment,null,wp.element.createElement("i",{className:"rm-icon rm-icon-analyzer",title:(0,s.__)("Research","rank-math")}),wp.element.createElement("span",null,(0,s.__)("Research","rank-math"))),view:Ct,className:"rank-math-general-tab"}])},(function(t){return wp.element.createElement("div",{className:"rank-math-tab-content-"+t.name},(0,c.createElement)(t.view,{setCredits:u}))})))}function Mt(t){return Mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mt(t)}function It(t,e,n){return(e=function(t){var e=function(t,e){if("object"!==Mt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var a=n.call(t,e||"default");if("object"!==Mt(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===Mt(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var At=(0,u.withSelect)((function(t){var e=t("rank-math"),n=Object.values(e.getContentAIScore());return n=(0,r.isEmpty)(n)||!rankMath.isUserRegistered?rankMath.contentAiScore:(0,r.round)((0,r.sum)(n)/n.length),{isLoaded:e.isLoaded(),score:(0,r.isUndefined)(n)?0:n}}))((function(t){var e,n=t.isLoaded,a=t.score,r=i()("rank-math-toolbar-score content-ai-score",(It(e={},V(a),!0),It(e,"loading",!n),e));return wp.element.createElement("div",{className:r},wp.element.createElement("i",{className:"rm-icon rm-icon-content-ai"}),wp.element.createElement("span",{className:"content-ai-score"},a," / 100"))}));function Pt(t){return Pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pt(t)}function jt(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,(i=a.key,r=void 0,r=function(t,e){if("object"!==Pt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var a=n.call(t,e||"default");if("object"!==Pt(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===Pt(r)?r:String(r)),a)}var i,r}var Lt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),rankMath.isUserRegistered&&(this.init=this.init.bind(this),this.contentLength=this.contentLength.bind(this),this.contentLengthBoundary=this.contentLengthBoundary.bind(this),this.keywordDensity=this.keywordDensity.bind(this),this.removeTests=this.removeTests.bind(this),this.researchesTests=rankMath.assessor.researchesTests,this.ca_keyword=rankMath.ca_keyword.keyword,(0,o.addAction)("rank_math_loaded","rank-math",this.init),(0,o.addAction)("rank_math_keyword_refresh","rank-math",this.init),(0,o.addAction)("rank_math_content_ai_changed","rank-math",this.init))}var e,n,a;return e=t,(n=[{key:"init",value:function(t){t&&(this.ca_keyword=t),this.keyword=rankMathEditor.assessor.getPrimaryKeyword(),this.data=(0,u.select)("rank-math").getKeywordsData(),(0,r.isEmpty)(this.data)||(this.filters(),this.removeTests(),t&&rankMathEditor.refresh("content"))}},{key:"removeTests",value:function(){if(this.ca_keyword===this.keyword){var t=this.data.recommendations;rankMath.assessor.researchesTests=(0,r.filter)(rankMath.assessor.researchesTests,(function(e){return!(!t.mediaCount&&"contentHasAssets"===e||!t.linkCount.internal&&"linksHasInternal"===e||!(t.linkCount.external||"linksHasExternals"!==e&&"linksNotAllExternals"!==e))}))}else rankMath.assessor.researchesTests=this.researchesTests}},{key:"filters",value:function(){(0,o.addFilter)("rankMath_analysis_contentLength","rank-math",this.contentLength),(0,o.addFilter)("rankMath_analysis_contentLength_boundaries","rank-math",this.contentLengthBoundary),(0,o.addFilter)("rankMath_analysis_keywordDensity","rank-math",this.keywordDensity)}},{key:"contentLength",value:function(t){if(this.ca_keyword!==this.keyword)return t;var e=this.data.recommendations.wordCount,n=(0,r.ceil)(150*e/100);return{hasScore:t.hasScore,failed:(0,s.sprintf)((0,s.__)("Content is %1$s words long. Consider using at least %2$s words.","rank-math"),"%1$d",e),tooltipText:(0,s.sprintf)((0,s.__)("Minimum recommended content length should be %1$d words.","rank-math"),e),emptyContent:(0,s.sprintf)((0,s.__)("Content should be %1$s long.","rank-math"),'<a href="https://rankmath.com/kb/score-100-in-tests/?utm_source=Plugin&utm_campaign=WP#overall-content-length" target="_blank">'+e+" - "+n+(0,s.__)(" words","rank-math")+"</a>")}}},{key:"contentLengthBoundary",value:function(t){if(this.ca_keyword!==this.keyword)return t;var e=this.data.recommendations.wordCount,n=(0,r.ceil)(150*e/100);return{recommended:{boundary:n,score:8},belowRecommended:{boundary:(0,r.ceil)(n/2),score:5},low:{boundary:e,score:2}}}},{key:"keywordDensity",value:function(t,e){if((0,r.isEmpty)(this.data.keywords.content)||(0,r.isEmpty)(this.data.keywords.content[this.keyword]))return t;var n=e/this.data.keywords.content[this.keyword].average*100;return n>80?1.1:100<n?2.5:80<n?1.1:50<n?.8:.5}}])&&jt(e.prototype,n),a&&jt(e,a),Object.defineProperty(e,"prototype",{writable:!1}),t}(),Rt=n(634),Vt=n.n(Rt);function Bt(t){return Bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bt(t)}function Ft(){return Ft=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Ft.apply(this,arguments)}function Ht(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,(i=a.key,r=void 0,r=function(t,e){if("object"!==Bt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var a=n.call(t,e||"default");if("object"!==Bt(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===Bt(r)?r:String(r)),a)}var i,r}function $t(t,e){return $t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},$t(t,e)}function Kt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,a=qt(t);if(e){var i=qt(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return function(t,e){if(e&&("object"===Bt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Ut(t)}(this,n)}}function Ut(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function qt(t){return qt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},qt(t)}var Wt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&$t(t,e)}(r,t);var e,n,a,i=Kt(r);function r(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),(e=i.call(this,t))._handleRef=e._handleRef.bind(Ut(e)),e}return e=r,(n=[{key:"componentDidMount",value:function(){var t=this;this.tagify=new(Vt())(this.component,this.props.settings||{}),this.props.settings.callbacks.setup&&setTimeout((function(){t.props.settings.callbacks.setup.call(t.tagify),t.tagify.DOM.input.setAttribute("contenteditable",!0),t.tagify.DOM.input.addEventListener("blur",t.props.settings.callbacks.blur)}),100),this.props.settings.callbacks.dragEnd&&this.tagify.DOM.scope.addEventListener("dragend",this.props.settings.callbacks.dragEnd),(0,o.doAction)("rank_math_tagify_init",this)}},{key:"shouldComponentUpdate",value:function(t){return this.tagify.settings.whitelist=t.settings.whitelist,t.showDropdown&&this.tagify.dropdown.show.call(this.tagify,t.showDropdown),!1===t.showDropdown&&this.tagify.dropdown.hide.call(this.tagify,!0),!1}},{key:"_handleRef",value:function(t){this.component=t}},{key:"render",value:function(){var t={ref:this._handleRef,id:this.props.id,name:this.props.name,className:this.props.className,placeholder:this.props.placeholder};return"textarea"===this.props.mode?wp.element.createElement("textarea",Ft({},t,{defaultValue:this.props.initialValue})):wp.element.createElement("input",Ft({},t,{defaultValue:this.props.initialValue}))}},{key:"toArray",value:function(){return this.tagify.value.map((function(t){return t.value}))}},{key:"toString",value:function(){return this.toArray().join(",")}},{key:"queryTags",value:function(){return this.tagify.DOM.scope.querySelectorAll("tag")}}])&&Ht(e.prototype,n),a&&Ht(e,a),Object.defineProperty(e,"prototype",{writable:!1}),r}(c.Component);window.rankMath=window.rankMath||{},window.rankMath.contentAIHelpers=window.rankMath.contentAIHelpers||{},window.rankMath.contentAIHelpers={generateId:function(t){return"".concat(t,"-").concat((new Date).getTime())},isTinymceActive:function(){return"undefined"!=typeof tinymce&&null!==tinymce.activeEditor&&!0!==tinymce.activeEditor.isHidden()&&"content"===tinymce.activeEditor.id},TagifyField:Wt};var zt=function(){var t=i()("button-secondary rank-math-content-ai",{"is-new":!rankMath.ca_viewed});return wp.element.createElement(l.Button,{className:t,onClick:function(){e()(".rank-math-toolbar-score.content-ai-score").length?e()(".rank-math-toolbar-score.content-ai-score").parent().trigger("click"):e()(".rank-math-content-ai-tab").trigger("click")}},wp.element.createElement("i",{className:"rm-icon rm-icon-content-ai"}),(0,s.__)("Content AI","rank-math"))};(0,o.addFilter)("rankMath.analytics.contentAI","rank-math",(function(){return zt})),(0,o.addAction)("rank_math_loaded","rank-math",(function(){(0,o.addFilter)("rank_math_sidebar_tabs","rank-math",(function(t){return t.push({name:"contentAI",title:wp.element.createElement(c.Fragment,null,wp.element.createElement("i",{className:"rm-icon rm-icon-content-ai"}),wp.element.createElement("span",null,(0,s.__)("Content AI","rank-math"))),view:Dt,className:"rank-math-content-ai-tab hidden is-active"}),t}));var t=document.getElementById("cmb2-metabox-rank_math_metabox_content_ai");if(t&&setTimeout((function(){(0,c.render)((0,c.createElement)(Dt),t)}),1e3),"gutenberg"===rankMath.currentEditor&&((0,d.registerPlugin)("rank-math-content-ai-box",{render:function(){var t=(0,u.select)("rank-math").getContentAIScore();return!(!(0,r.isEmpty)(t)||!(0,r.isEmpty)(rankMath.ca_keyword))&&wp.element.createElement(h.PluginPrePublishPanel,{title:(0,s.__)("Content AI","rank-math"),icon:"rm-icon rm-icon-content-ai",initialOpen:"true",className:"rank-math-content-ai-box"},wp.element.createElement("p",null,(0,s.__)("Improve your content with a personal Content AI.","rank-math")),wp.element.createElement(l.Button,{className:"button-primary",onClick:function(){e()(".editor-post-publish-panel__header-cancel-button button").trigger("click"),e()(".rank-math-toolbar-score").parent().hasClass("is-pressed")||e()(".rank-math-toolbar-score").trigger("click"),setTimeout((function(){e()(".rank-math-content-ai-tab").trigger("click")}),100)}},(0,s.__)("Improve Now","rank-math")))}}),"gutenberg"===rankMath.currentEditor)){var n=function(){return wp.element.createElement(c.Fragment,null,wp.element.createElement(h.PluginSidebarMoreMenuItem,{target:"seo-by-rank-math-content-ai-sidebar",icon:wp.element.createElement(At,null)},(0,s.__)("Content AI","rank-math")),wp.element.createElement(h.PluginSidebar,{name:"seo-by-rank-math-content-ai-sidebar",title:(0,s.__)("Content AI","rank-math"),className:"rank-math-sidebar-panel rank-math-sidebar-content-ai-panel"},wp.element.createElement(Dt,null)))};setTimeout((function(){(0,d.registerPlugin)("rank-math-content-ai",{icon:wp.element.createElement(At,null),render:n})}),1e3)}"classic"!==rankMath.currentEditor&&e()(document).on("click",".rank-math-open-contentai",(function(t){return t.preventDefault(),e()(".rank-math-content-ai-tab").trigger("click"),!1})),new Lt}))}()}();